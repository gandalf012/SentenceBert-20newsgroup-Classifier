<!DOCTYPE html>
<!-- saved from url=(0370)https://disqus.com/embed/comments/?base=default&f=omoindrot-github-io&t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&s_o=default#version=44742cd8863826760a96af6b1ed3cde1 -->
<html lang="en" dir="ltr" class="js no-touch localstorage sessionstorage contenteditable use-opacity-transitions"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Disqus Comments</title>

    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <style>
        .alert--warning {
            border-radius: 3px;
            padding: 10px 15px;
            margin-bottom: 10px;
            background-color: #FFE070;
            color: #A47703;
        }

        .alert--warning a,
        .alert--warning a:hover,
        .alert--warning strong {
            color: #A47703;
            font-weight: bold;
        }

        .alert--error p,
        .alert--warning p {
            margin-top: 5px;
            margin-bottom: 5px;
        }
        
        </style>
    
    <style>
        
        html {
            overflow: hidden;
        }
        

        #error {
            display: none;
        }

        .clearfix:after {
            content: "";
            display: block;
            height: 0;
            clear: both;
            visibility: hidden;
        }

        
    </style>

<script crossorigin="anonymous" id="bootstrap-script" data-app="lounge" src="./lounge.load.44742cd8863826760a96af6b1ed3cde1.js"></script><meta http-equiv="Content-Security-Policy" content="script-src https:;"><link rel="stylesheet" href="./lounge.6525595c7a9874fa10bd041275e40f17.css"><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="lounge/main" src="./lounge.bundle.277f9ff2e410eacf604c2762b3003e57.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="remote/config" src="./config.js"></script><style id="css_1597749955584"></style><!--<base target="_parent">--><base href="." target="_parent"><link rel="stylesheet" href="./recommendations.45f13554f8a372340589f7312bb44621.css"><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="recommendations/main" src="./recommendations.bundle.baf6e3fc6bd5dc65efc3be8dc20f0f7d.js"></script></head>
<body>
    

    
    <div id="error" class="alert--error">
        <p>We were unable to load Disqus. If you are a moderator please see our <a href="https://docs.disqus.com/help/83/"> troubleshooting guide</a>. </p>
    </div>

    
    <script type="text/json" id="disqus-forumData">{"session":{"canModerate":false,"audienceSyncVerified":false,"mustVerify":false,"canReply":true,"mustVerifyEmail":false},"forum":{"aetBannerConfirmation":null,"founder":"232266951","twitterName":null,"commentsLinkOne":"1 Comment","guidelines":null,"favicon":{"permalink":"https://disqus.com/api/forums/favicons/omoindrot-github-io.jpg","cache":"//a.disquscdn.com/1595026414/images/favicon-default.png"},"commentsLinkZero":"0 Comments","disableDisqusBranding":false,"id":"omoindrot-github-io","createdAt":"2017-05-19T21:27:04.609140","category":"Tech","aetBannerEnabled":false,"aetBannerTitle":null,"raw_guidelines":null,"colorScheme":"light","votingType":null,"installCompleted":true,"moderatorBadgeText":"","commentPolicyText":null,"aetEnabled":false,"channel":null,"sort":4,"description":null,"newPolicy":true,"raw_description":null,"language":"en","adsReviewStatus":0,"pk":"5136996","daysAlive":0,"forumCategory":{"date_added":"2016-01-28T01:54:31","id":8,"name":"Tech"},"permissions":{},"commentPolicyLink":null,"aetBannerDescription":null,"name":"omoindrot.github.io","commentsLinkMultiple":"{num} Comments","settings":{"threadRatingsEnabled":false,"adsDRNativeEnabled":false,"behindClickEnabled":false,"disable3rdPartyTrackers":false,"adsVideoEnabled":false,"adsProductVideoEnabled":false,"adsPositionTopEnabled":false,"ssoRequired":false,"unapproveLinks":false,"adsPositionRecommendationsEnabled":false,"linkAffiliationEnabled":true,"adsProductLinksThumbnailsEnabled":false,"hasCustomAvatar":false,"organicDiscoveryEnabled":true,"adsProductDisplayEnabled":false,"adsProductLinksEnabled":false,"threadReactionsEnabled":false,"adsEnabled":false,"disableSocialShare":false,"allowAnonPost":false,"adsProductStoriesEnabled":false,"adultContent":false,"allowAnonVotes":false,"gifPickerEnabled":true,"mustVerify":true,"mustVerifyEmail":true,"audienceSyncEnabled":false,"mediaembedEnabled":true,"adsPositionBottomEnabled":false,"discoveryLocked":false,"validateAllPosts":false,"adsSettingsLocked":false,"isVIP":false,"adsPositionInthreadEnabled":false},"organizationId":3881522,"typeface":"auto","url":"https://omoindrot.github.io","daysThreadAlive":0,"avatar":{"small":{"permalink":"https://disqus.com/api/forums/avatars/omoindrot-github-io.jpg?size=32","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"large":{"permalink":"https://disqus.com/api/forums/avatars/omoindrot-github-io.jpg?size=92","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}},"signedUrl":"https://disq.us/?url=https%3A%2F%2Fomoindrot.github.io&key=CVYYKSnepMoosm4tEj35PQ"}}</script>

    <script type="text/json" id="disqus-threadData">{"cursor":{"hasPrev":false,"prev":null,"total":119,"hasNext":true,"next":"1:0:0"},"code":0,"response":{"lastModified":1597040273,"posts":[{"editableUntil":"2018-11-22T10:06:32","dislikes":0,"thread":"6564336423","numReports":0,"likes":5,"message":"\u003cp>Man, the way you use matrix multiplication and broadcasting here seems absolutely beautiful to me. It was really a massive pleasure to read this post!\u003c/p>","id":"4195994592","createdAt":"2018-11-15T10:06:32","author":{"username":"simonbernhard","about":"","name":"Simon Bernhard","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-02-05T19:39:57","profileUrl":"https://disqus.com/by/simonbernhard/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"195165794","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/simonbernhard.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/simonbernhard.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/simonbernhard.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Man, the way you use matrix multiplication and broadcasting here seems absolutely beautiful to me. It was really a massive pleasure to read this post!","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":5,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-11-22T10:55:08","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>Thank you, finally someone sees the beauty in it !\u003c/p>","id":"4196116023","createdAt":"2018-11-15T10:55:08","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4195994592,"isApproved":true,"isFlagged":false,"raw_message":"Thank you, finally someone sees the beauty in it !","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-07-17T16:01:02","dislikes":0,"thread":"6564336423","numReports":0,"likes":2,"message":"\u003cp>Thank you \u003ca data-dsq-mention=\"oliviermoindrot:disqus\" href=\"https://disqus.com/by/oliviermoindrot/\" rel=\"nofollow noopener\" title=\"https://disqus.com/by/oliviermoindrot/\">Olivier Moindrot\u003c/a> for your post. It really helped me with my project. Just one note, I edited the batch hard loss function, so for each anchor, I select the hardest k positives and hardest k negatives, which got me better results for my problem, than just using the hardest +ve and -ve.\u003c/p>\u003cp>Hope that help others as well!\u003c/p>","id":"3982124794","createdAt":"2018-07-10T16:01:02","author":{"username":"bkhmsi","about":"","name":"Badr AlKhamissi","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2014-08-25T16:26:02","profileUrl":"https://disqus.com/by/bkhmsi/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"119505227","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/bkhmsi.jpg","cache":"https://c.disquscdn.com/uploads/users/11950/5227/avatar32.jpg?1408984084"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/bkhmsi.jpg","cache":"https://c.disquscdn.com/uploads/users/11950/5227/avatar92.jpg?1408984084","large":{"permalink":"https://disqus.com/api/users/avatars/bkhmsi.jpg","cache":"https://c.disquscdn.com/uploads/users/11950/5227/avatar92.jpg?1408984084"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Thank you @oliviermoindrot:disqus for your post. It really helped me with my project. Just one note, I edited the batch hard loss function, so for each anchor, I select the hardest k positives and hardest k negatives, which got me better results for my problem, than just using the hardest +ve and -ve. \n\nHope that help others as well!","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":2,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-07-18T16:15:53","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>You're right it's definitely possible to take the hardest k, and as you increase k it will look more and more like the batch all strategy.\u003c/p>","id":"3983917460","createdAt":"2018-07-11T16:15:53","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":3982124794,"isApproved":true,"isFlagged":false,"raw_message":"You're right it's definitely possible to take the hardest k, and as you increase k it will look more and more like the batch all strategy.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-04-01T03:24:46","dislikes":0,"thread":"6564336423","numReports":0,"likes":2,"message":"\u003cp>\"However, we don\u2019t want to push the train embeddings of each label to collapse into very small clusters.\"\u003c/p>\u003cp>Why not? More recent papers such as SphereFace are trying to do so.\u003c/p>","id":"3822922583","createdAt":"2018-03-25T03:24:46","author":{"username":"cc_ss","about":"","name":"cc ss","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2018-03-25T03:24:40","profileUrl":"https://disqus.com/by/cc_ss/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"283665762","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/cc_ss.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/cc_ss.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/cc_ss.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"\"However, we don\u2019t want to push the train embeddings of each label to collapse into very small clusters.\"\n\nWhy not? More recent papers such as SphereFace are trying to do so.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":2,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-04-01T19:13:41","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>When I mentioned that I meant that if you want to do classification or any task based on the embeddings, you only need the intra-cluster distance to be smaller than the inter-cluster distance. If you have that, then two examples from the same class will always have their embeddings closer than two examples from different classes.\u003cbr>Once this is done, you don't really need to push the clusters closer together. My intuition is that if you do so, it's a form of overfitting and you will lose in test accuracy.\u003c/p>\u003cp>In SphereFace they do something similar to softmax. Softmax is also going to push the predictions as close to 0 or to 1 as possible, which is to me a form of overfitting.\u003c/p>","id":"3823879226","createdAt":"2018-03-25T19:13:41","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":3822922583,"isApproved":true,"isFlagged":false,"raw_message":"When I mentioned that I meant that if you want to do classification or any task based on the embeddings, you only need the intra-cluster distance to be smaller than the inter-cluster distance. If you have that, then two examples from the same class will always have their embeddings closer than two examples from different classes.\nOnce this is done, you don't really need to push the clusters closer together. My intuition is that if you do so, it's a form of overfitting and you will lose in test accuracy.\n\nIn SphereFace they do something similar to softmax. Softmax is also going to push the predictions as close to 0 or to 1 as possible, which is to me a form of overfitting.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-04-10T20:50:30","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>What if you just use the square of the distance between two points? The gradient will decay the closer the two points are. Which should mean that clusters collapse far slower. There is something awkward with the proposed method of triplet loss, the margin is artificial and points which are close to it may not be well generalized to. Maybe make the margin dynamic somehow?\u003c/p>","id":"3837669444","createdAt":"2018-04-03T20:50:30","author":{"username":"disqus_knPjPMDHhO","about":"","name":"Trevor","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-08-05T02:08:31","profileUrl":"https://disqus.com/by/disqus_knPjPMDHhO/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"217518914","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_knPjPMDHhO.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_knPjPMDHhO.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_knPjPMDHhO.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":3823879226,"isApproved":true,"isFlagged":false,"raw_message":"What if you just use the square of the distance between two points? The gradient will decay the closer the two points are. Which should mean that clusters collapse far slower. There is something awkward with the proposed method of triplet loss, the margin is artificial and points which are close to it may not be well generalized to. Maybe make the margin dynamic somehow?","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":2,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-04-10T22:15:30","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>I'm not sure what you mean when you propose to just take the squared distance between two points as the loss. If you refer to contrastive loss, it works but triplet loss is better.\u003c/p>","id":"3837804786","createdAt":"2018-04-03T22:15:30","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":3837669444,"isApproved":true,"isFlagged":false,"raw_message":"I'm not sure what you mean when you propose to just take the squared distance between two points as the loss. If you refer to contrastive loss, it works but triplet loss is better.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":3,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-07-16T17:06:42","dislikes":1,"thread":"6564336423","numReports":0,"likes":3,"message":"\u003cp>Theoretical Question: What if you split the loss in 2 parts:\u003c/p>\u003cp>loss = max(||d(a, p)||2, margin_p) - min(||d(a, p)||2, margin_n)\u003c/p>\u003cp>This way you can still learn to bring positives examples together within a margin_p radius or push back negative examples up to a margin_n radius regardless of the specific triplet chosen.\u003c/p>","id":"3980602634","createdAt":"2018-07-09T17:06:42","author":{"username":"disqus_zjk7JctwgC","about":"","name":"Cristian Garcia","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2014-01-02T06:16:19","profileUrl":"https://disqus.com/by/disqus_zjk7JctwgC/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"88801748","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_zjk7JctwgC.jpg","cache":"https://c.disquscdn.com/uploads/users/8880/1748/avatar32.jpg?1574781459"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_zjk7JctwgC.jpg","cache":"https://c.disquscdn.com/uploads/users/8880/1748/avatar92.jpg?1574781459","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_zjk7JctwgC.jpg","cache":"https://c.disquscdn.com/uploads/users/8880/1748/avatar92.jpg?1574781459"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Theoretical Question: What if you split the loss in 2 parts:\n\nloss = max(||d(a, p)||2, margin_p) - min(||d(a, p)||2, margin_n)\n\nThis way you can still learn to bring positives examples together within a margin_p radius or push back negative examples up to a margin_n radius regardless of the specific triplet chosen.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":2,"moderationLabels":[],"isEdited":true,"sb":false},{"editableUntil":"2018-07-18T16:32:54","dislikes":0,"thread":"6564336423","numReports":0,"likes":2,"message":"\u003cp>I think you meant with a \"n\" in the second term:\u003cbr>loss = max( d(a,p), margin_p) - min(d(a, n), margin_n)\u003c/p>\u003cp>In this case you don't even need triplets and you can just work on pairs of images. If you have a positive pair the loss is:\u003cbr>loss = max( d(a,p), margin_p)\u003c/p>\u003cp>If you have a negative pair the loss is:\u003cbr>loss = - min( d(a,n), margin_n)\u003c/p>\u003cp>This is very similar to the contrastive loss, you just have an additional parameter for the positive margin here. Triplet loss usually works better according to this paper: \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Farxiv.org%2Fabs%2F1706.07567%3AhOLb4pkewqIoDvAEmmRUY7CmdGg&amp;cuid=5136996\" rel=\"nofollow noopener\" title=\"https://arxiv.org/abs/1706.07567\">https://arxiv.org/abs/1706....\u003c/a>\u003c/p>","id":"3983944498","createdAt":"2018-07-11T16:32:54","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":3980602634,"isApproved":true,"isFlagged":false,"raw_message":"I think you meant with a \"n\" in the second term:\nloss = max( d(a,p), margin_p) - min(d(a, n), margin_n)\n\nIn this case you don't even need triplets and you can just work on pairs of images. If you have a positive pair the loss is:\nloss = max( d(a,p), margin_p)\n\nIf you have a negative pair the loss is:\nloss = - min( d(a,n), margin_n)\n\nThis is very similar to the contrastive loss, you just have an additional parameter for the positive margin here. Triplet loss usually works better according to this paper: https://arxiv.org/abs/1706.07567","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":1,"points":2,"moderationLabels":["links"],"isEdited":false,"sb":false},{"editableUntil":"2019-05-30T07:05:44","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>how to decide the margin value, i mean whatever strategy i use i,e batch all,batch hard the loss of the model is always same and number of true positives is same through out the train. Any pointers and tips should i consider while training or is it the problem of the data.\u003c/p>","id":"4473507818","createdAt":"2019-05-23T07:05:44","author":{"username":"disqus_MPXyUXcLl0","about":"","name":"Sainath Reddy","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-12-03T14:12:50","profileUrl":"https://disqus.com/by/disqus_MPXyUXcLl0/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"233100824","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_MPXyUXcLl0.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_MPXyUXcLl0.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_MPXyUXcLl0.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"how to decide the margin value, i mean whatever strategy i use i,e batch all,batch hard the loss of the model is always same and number of true positives is same through out the train. Any pointers and tips should i consider while training or is it the problem of the data.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2019-06-01T08:51:20","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>Maybe try to decrease the learning rate, since all the embeddings might have collapsed to the same point.\u003c/p>","id":"4476191324","createdAt":"2019-05-25T08:51:20","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4473507818,"isApproved":true,"isFlagged":false,"raw_message":"Maybe try to decrease the learning rate, since all the embeddings might have collapsed to the same point.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2019-06-03T05:09:01","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>yeah i have tried decreasing loss even though the number of true triplets is same through out the training.\u003c/p>","id":"4478278782","createdAt":"2019-05-27T05:09:01","author":{"username":"disqus_MPXyUXcLl0","about":"","name":"Sainath Reddy","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-12-03T14:12:50","profileUrl":"https://disqus.com/by/disqus_MPXyUXcLl0/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"233100824","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_MPXyUXcLl0.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_MPXyUXcLl0.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_MPXyUXcLl0.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4476191324,"isApproved":true,"isFlagged":false,"raw_message":"yeah i have tried decreasing loss even though the number of true triplets is same through out the training.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":2,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2019-02-14T18:27:08","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>Hi Olivier Moindrot,\u003cbr>Thank you for the post! It's really help me.  I am trying to use the triplet loss for my research. There are some questions really bother me for a long time.  Could you help me?\u003cbr>The questions are:\u003cbr>- How do we compute the accuracy for the results? \u003cbr>- Our input is a set (a,p,n). When I want to know if two photos are the same person, I only have two pictures but our model have to input three pictures. How can I do?\u003c/p>\u003cp>Thanks in advance.\u003c/p>","id":"4326885409","createdAt":"2019-02-07T18:27:08","author":{"username":"disqus_9rpOocX6Tq","about":"","name":"\u9673\u9756\u739f","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2019-02-07T18:07:42","profileUrl":"https://disqus.com/by/disqus_9rpOocX6Tq/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"328572070","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_9rpOocX6Tq.jpg","cache":"https://c.disquscdn.com/uploads/users/32857/2070/avatar32.jpg?1549564029"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_9rpOocX6Tq.jpg","cache":"https://c.disquscdn.com/uploads/users/32857/2070/avatar92.jpg?1549564029","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_9rpOocX6Tq.jpg","cache":"https://c.disquscdn.com/uploads/users/32857/2070/avatar92.jpg?1549564029"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Hi Olivier Moindrot,\nThank you for the post! It's really help me.  I am trying to use the triplet loss for my research. There are some questions really bother me for a long time.  Could you help me?\nThe questions are:\n- How do we compute the accuracy for the results? \n- Our input is a set (a,p,n). When I want to know if two photos are the same person, I only have two pictures but our model have to input three pictures. How can I do?\n\nThanks in advance.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2019-03-01T09:24:45","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>For the second question, if you follow my code then you don't have a set (a, p, n) as input. You have a batch of examples as input, and then you compute the triplet loss online on this batch of examples.\u003c/p>\u003cp>In any case, you should be able to run your trained model to produce embeddings for each face. You can then compute the cosine distance between faces to see if they match (lower distance = better match).\u003c/p>","id":"4349100683","createdAt":"2019-02-22T09:24:45","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4326885409,"isApproved":true,"isFlagged":false,"raw_message":"For the second question, if you follow my code then you don't have a set (a, p, n) as input. You have a batch of examples as input, and then you compute the triplet loss online on this batch of examples.\n\nIn any case, you should be able to run your trained model to produce embeddings for each face. You can then compute the cosine distance between faces to see if they match (lower distance = better match).","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2019-03-01T09:23:18","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>I suppose you are working in face recognition.\u003c/p>\u003cp>For the evaluation metric, you can use the rank-N metric.\u003cbr>For each face in the test set, you compute how much they match with each identity in the training set. This gives you an ordered list of identities (ex: Brad Pitt, Barack Obama...). If the original face was of Barack Obama, the rank of the true label is 2.\u003c/p>\u003cp>The rank-N metric is the proportion of predictions in the top N for each face in the test set.\u003c/p>\u003cp>So rank-1 metric is the proportion of faces with correct precision.\u003c/p>\u003cp>In general you can plot this metric for all rank N = 1, 2, 3... and see how it evolves.\u003c/p>","id":"4349099726","createdAt":"2019-02-22T09:23:18","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4326885409,"isApproved":true,"isFlagged":false,"raw_message":"I suppose you are working in face recognition.\n\nFor the evaluation metric, you can use the rank-N metric.\nFor each face in the test set, you compute how much they match with each identity in the training set. This gives you an ordered list of identities (ex: Brad Pitt, Barack Obama...). If the original face was of Barack Obama, the rank of the true label is 2.\n\nThe rank-N metric is the proportion of predictions in the top N for each face in the test set.\n\nSo rank-1 metric is the proportion of faces with correct precision.\n\n\nIn general you can plot this metric for all rank N = 1, 2, 3... and see how it evolves.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":1,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2019-11-24T18:57:27","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>Hi! Thanks so much for this informative post and implementation. To implement rank-1 accuracy, would you use KNN from sklearn? Or maybe you could use pairwise distances excluding the diagonal and just take the min?\u003c/p>","id":"4692876641","createdAt":"2019-11-17T18:57:27","author":{"username":"AdamDKlein","about":"","name":"AdamDKlein","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-07-19T00:57:37","profileUrl":"https://disqus.com/by/AdamDKlein/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"14171729","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/AdamDKlein.jpg","cache":"https://c.disquscdn.com/uploads/users/1417/1729/avatar32.jpg?1579530713"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/AdamDKlein.jpg","cache":"https://c.disquscdn.com/uploads/users/1417/1729/avatar92.jpg?1579530713","large":{"permalink":"https://disqus.com/api/users/avatars/AdamDKlein.jpg","cache":"https://c.disquscdn.com/uploads/users/1417/1729/avatar92.jpg?1579530713"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4349099726,"isApproved":true,"isFlagged":false,"raw_message":"Hi! Thanks so much for this informative post and implementation. To implement rank-1 accuracy, would you use KNN from sklearn? Or maybe you could use pairwise distances excluding the diagonal and just take the min?","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":2,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2020-01-27T10:28:08","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>Hi, I'm also interested in evaluating the model with rank-1 accuracy. How did you implement it in the end? Could you even share some code? That would be amazing. Thanks a lot!\u003c/p>","id":"4763827932","createdAt":"2020-01-20T10:28:08","author":{"username":"emanueloehri","about":"","name":"eoehri","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2020-01-20T10:26:58","profileUrl":"https://disqus.com/by/emanueloehri/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"343601307","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/emanueloehri.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/emanueloehri.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/emanueloehri.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4692876641,"isApproved":true,"isFlagged":false,"raw_message":"Hi, I'm also interested in evaluating the model with rank-1 accuracy. How did you implement it in the end? Could you even share some code? That would be amazing. Thanks a lot!","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":3,"points":0,"moderationLabels":[],"isEdited":true,"sb":false},{"editableUntil":"2020-01-27T14:31:48","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>I used KNN from sklearn on the test set, as that part is a pretty trivial thing to do. I didn't use it as a training metric.\u003c/p>","id":"4764004187","createdAt":"2020-01-20T14:31:48","author":{"username":"AdamDKlein","about":"","name":"AdamDKlein","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2011-07-19T00:57:37","profileUrl":"https://disqus.com/by/AdamDKlein/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"14171729","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/AdamDKlein.jpg","cache":"https://c.disquscdn.com/uploads/users/1417/1729/avatar32.jpg?1579530713"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/AdamDKlein.jpg","cache":"https://c.disquscdn.com/uploads/users/1417/1729/avatar92.jpg?1579530713","large":{"permalink":"https://disqus.com/api/users/avatars/AdamDKlein.jpg","cache":"https://c.disquscdn.com/uploads/users/1417/1729/avatar92.jpg?1579530713"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4763827932,"isApproved":true,"isFlagged":false,"raw_message":"I used KNN from sklearn on the test set, as that part is a pretty trivial thing to do. I didn't use it as a training metric.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":4,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-11-23T11:54:43","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>is there any specific reason to use _pairwise_distances and not scipy.spatial.distance.pdist?\u003c/p>","id":"4197901941","createdAt":"2018-11-16T11:54:43","author":{"username":"shakedhiba","about":"","name":"Shaked Hiba","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2018-11-16T11:52:33","profileUrl":"https://disqus.com/by/shakedhiba/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"325206143","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/shakedhiba.jpg","cache":"https://c.disquscdn.com/uploads/users/32520/6143/avatar32.jpg?1542369285"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/shakedhiba.jpg","cache":"https://c.disquscdn.com/uploads/users/32520/6143/avatar92.jpg?1542369285","large":{"permalink":"https://disqus.com/api/users/avatars/shakedhiba.jpg","cache":"https://c.disquscdn.com/uploads/users/32520/6143/avatar92.jpg?1542369285"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"is there any specific reason to use _pairwise_distances and not scipy.spatial.distance.pdist?","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-11-23T13:42:08","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>Well you have to create everything inside the TensorFlow graph to have gradients and to be able to run backpropagation.\u003c/p>","id":"4198024133","createdAt":"2018-11-16T13:42:08","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4197901941,"isApproved":true,"isFlagged":false,"raw_message":"Well you have to create everything inside the TensorFlow graph to have gradients and to be able to run backpropagation.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":1,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2020-06-16T07:22:09","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>Hi Oliver, we can compute the triplets using batch hard or batch all technique outside tensorflow(in python for ex) and design tf graph such that it receives triplets as inputs instead of batch of images. Is there any advantage of keeping triplets creating code inside TF?\u003c/p>","id":"4946805975","createdAt":"2020-06-09T07:22:09","author":{"username":"disqus_SniTvkrZqx","about":"","name":"Anil Kumar","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-08-05T06:24:30","profileUrl":"https://disqus.com/by/disqus_SniTvkrZqx/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"217534136","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_SniTvkrZqx.jpg","cache":"https://c.disquscdn.com/uploads/users/21753/4136/avatar32.jpg?1591687331"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_SniTvkrZqx.jpg","cache":"https://c.disquscdn.com/uploads/users/21753/4136/avatar92.jpg?1591687331","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_SniTvkrZqx.jpg","cache":"https://c.disquscdn.com/uploads/users/21753/4136/avatar92.jpg?1591687331"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4198024133,"isApproved":true,"isFlagged":false,"raw_message":"Hi Oliver, we can compute the triplets using batch hard or batch all technique outside tensorflow(in python for ex) and design tf graph such that it receives triplets as inputs instead of batch of images. Is there any advantage of keeping triplets creating code inside TF?","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":2,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-11-12T07:48:38","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>Hey Olivier\u003cbr>I am trying to implement triplet loss for cross-modality retrieval problem in keras. This blog post saved my day. Thanks a lot.\u003c/p>","id":"4179026030","createdAt":"2018-11-05T07:48:38","author":{"username":"disqus_Og25rIyjhB","about":"","name":"Deepak Nathani","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2018-11-05T07:44:17","profileUrl":"https://disqus.com/by/disqus_Og25rIyjhB/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"324686852","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_Og25rIyjhB.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_Og25rIyjhB.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_Og25rIyjhB.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Hey Olivier\nI am trying to implement triplet loss for cross-modality retrieval problem in keras. This blog post saved my day. Thanks a lot.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-09-21T10:17:24","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>Hi Olivier Moindrot,\u003c/p>\u003cp>Very nice post and really helpful, I am trying to run the code from your github with mnist dataset. I could notice that loss is not going down continuously, it oscillates.  Is it correct behavior?\u003c/p>\u003cp>Thanks,\u003cbr>Veeru.\u003c/p>","id":"4094888102","createdAt":"2018-09-14T10:17:24","author":{"username":"veeranjaneyulutoka","about":"","name":"Veeranjaneyulu TOka","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2017-04-27T08:42:55","profileUrl":"https://disqus.com/by/veeranjaneyulutoka/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"250125618","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/veeranjaneyulutoka.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/veeranjaneyulutoka.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/veeranjaneyulutoka.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Hi Olivier Moindrot,\n\nVery nice post and really helpful, I am trying to run the code from your github with mnist dataset. I could notice that loss is not going down continuously, it oscillates.  Is it correct behavior?\n\nThanks,\nVeeru.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-09-27T16:58:14","dislikes":0,"thread":"6564336423","numReports":0,"likes":2,"message":"\u003cp>Hi,\u003c/p>\u003cp>This is totally normal. The loss is the average over all triplets which have a positive loss.\u003c/p>\u003cp>For instance at the beginning of training, you'll have 1000 triplets with positive loss, and the average loss might be 0.7.\u003c/p>\u003cp>At the end of training, you might have only 10 triplets with positive loss (because the model has converged) but the average loss might still be at 0.8 for instance.\u003c/p>\u003cp>If you want to see if your model converge, you should follow the plot of the number of positive triplets.\u003c/p>","id":"4105610586","createdAt":"2018-09-20T16:58:14","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4094888102,"isApproved":true,"isFlagged":false,"raw_message":"Hi,\n\nThis is totally normal. The loss is the average over all triplets which have a positive loss.\n\nFor instance at the beginning of training, you'll have 1000 triplets with positive loss, and the average loss might be 0.7.\n\nAt the end of training, you might have only 10 triplets with positive loss (because the model has converged) but the average loss might still be at 0.8 for instance.\n\n\nIf you want to see if your model converge, you should follow the plot of the number of positive triplets.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":1,"points":2,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-10-06T01:42:28","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>for this question, I'm curious why not take the sum of the positive triplet loss as the final loss but the average value. Will it affect the convegence?\u003c/p>","id":"4119976523","createdAt":"2018-09-29T01:42:28","author":{"username":"disqus_BqfGw61S5w","about":"","name":"\u5f20\u6167\u8d85","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2018-09-29T01:42:08","profileUrl":"https://disqus.com/by/disqus_BqfGw61S5w/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"322859086","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_BqfGw61S5w.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_BqfGw61S5w.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_BqfGw61S5w.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4105610586,"isApproved":true,"isFlagged":false,"raw_message":"for this question, I'm curious why not take the sum of the positive triplet loss as the final loss but the average value. Will it affect the convegence?","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":2,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-10-09T09:46:18","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>(In general it's better to take the average over the batch, and not the sum so that your loss is about the same if you change the batch size)\u003c/p>\u003cp>Your question is: \"what would happen if we take the average over all triplets, and not over all triplets with positive loss\".\u003c/p>\u003cp>In practice the only difference is that the scale of the loss would be lower. So if only 1% of triplets have positive loss, the loss would be divided by 100 which amount to having a lower learning rate.\u003c/p>\u003cp>I chose to take the average over positive triplets so that the loss is always in the same range, and you can manually decrease the learning rate if you want.\u003c/p>","id":"4124832422","createdAt":"2018-10-02T09:46:18","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4119976523,"isApproved":true,"isFlagged":false,"raw_message":"(In general it's better to take the average over the batch, and not the sum so that your loss is about the same if you change the batch size)\n\nYour question is: \"what would happen if we take the average over all triplets, and not over all triplets with positive loss\".\n\nIn practice the only difference is that the scale of the loss would be lower. So if only 1% of triplets have positive loss, the loss would be divided by 100 which amount to having a lower learning rate.\n\nI chose to take the average over positive triplets so that the loss is always in the same range, and you can manually decrease the learning rate if you want.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":3,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2020-02-04T04:13:05","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>I posted a question regarding this \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fomoindrot%2Ftensorflow-triplet-loss%2Fissues%2F55%3Afgap_IWp1Bmm4HXVFxYM5PtRljU&amp;cuid=5136996\" rel=\"nofollow noopener\" title=\"https://github.com/omoindrot/tensorflow-triplet-loss/issues/55\">here\u003c/a>\u003c/p>","id":"4773882563","createdAt":"2020-01-28T04:13:05","author":{"username":"hongtaoyang","about":"","name":"Hongtao Yang","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2020-01-28T04:09:41","profileUrl":"https://disqus.com/by/hongtaoyang/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"343946544","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/hongtaoyang.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/hongtaoyang.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/hongtaoyang.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4124832422,"isApproved":true,"isFlagged":false,"raw_message":"I posted a question regarding this \u003ca href=\"https://github.com/omoindrot/tensorflow-triplet-loss/issues/55\">here\u003c/a>","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":4,"points":0,"moderationLabels":["links"],"isEdited":false,"sb":false},{"editableUntil":"2018-10-01T09:53:03","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>Thank you for your quick reply. I am trying to run on my own dataset (fashion data set), and wondering what should i pass as labels?\u003c/p>\u003cp>Thanks,\u003cbr>Veeru.\u003c/p>","id":"4111217985","createdAt":"2018-09-24T09:53:03","author":{"username":"veeranjaneyulutoka","about":"","name":"Veeranjaneyulu TOka","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2017-04-27T08:42:55","profileUrl":"https://disqus.com/by/veeranjaneyulutoka/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"250125618","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/veeranjaneyulutoka.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/veeranjaneyulutoka.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/veeranjaneyulutoka.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4105610586,"isApproved":true,"isFlagged":false,"raw_message":"Thank you for your quick reply. I am trying to run on my own dataset (fashion data set), and wondering what should i pass as labels?\n\n\nThanks,\nVeeru.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":2,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-10-02T09:13:30","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>It depends on what you want to do, and what you have available.\u003c/p>\u003cp>For instance the labels could be the id of the dress in the picture (for instance) so that multiple views of the dress have the same id. This is similar to face recognition where the label is the identity of the person in the photo.\u003c/p>\u003cp>Or the labels could be the type of clothing...\u003c/p>","id":"4112971599","createdAt":"2018-09-25T09:13:30","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4111217985,"isApproved":true,"isFlagged":false,"raw_message":"It depends on what you want to do, and what you have available.\n\nFor instance the labels could be the id of the dress in the picture (for instance) so that multiple views of the dress have the same id. This is similar to face recognition where the label is the identity of the person in the photo.\n\nOr the labels could be the type of clothing...","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":3,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-08-20T06:17:34","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>just question how normally prediction after you get new embedding from triplet losses, any idea or just any classifier would work ?\u003c/p>","id":"4037175871","createdAt":"2018-08-13T06:17:34","author":{"username":"qilongzhao","about":"","name":"Qilong Zhao","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2018-08-13T06:17:20","profileUrl":"https://disqus.com/by/qilongzhao/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"294490195","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/qilongzhao.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/qilongzhao.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/qilongzhao.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"just question how normally prediction after you get new embedding from triplet losses, any idea or just any classifier would work ?","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-08-27T09:10:49","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>You can see a similar discussion here: \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fomoindrot%2Ftensorflow-triplet-loss%2Fissues%2F5%3A33xPWUW5C8_ru1Ex55XNr1pUy9I&amp;cuid=5136996\" rel=\"nofollow noopener\" title=\"https://github.com/omoindrot/tensorflow-triplet-loss/issues/5\">https://github.com/omoindro...\u003c/a>\u003c/p>","id":"4049628343","createdAt":"2018-08-20T09:10:49","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4037175871,"isApproved":true,"isFlagged":false,"raw_message":"You can see a similar discussion here: https://github.com/omoindrot/tensorflow-triplet-loss/issues/5","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":1,"points":0,"moderationLabels":["links"],"isEdited":false,"sb":false},{"editableUntil":"2018-04-11T16:41:45","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>Hi Olivier. Very Nice blog. If Mnist had thousands of classes instead of 10. Have you thought how to modify your code to be sure that you have multiple image of same class in a each single batch. I am asking this question because I would like to implement triplet loss with database of more than 10 thousands of classes.\u003c/p>","id":"3838943932","createdAt":"2018-04-04T16:41:45","author":{"username":"s_bastien_le_gall","about":"","name":"S\u00e9bastien LE GALL","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2018-04-04T16:31:51","profileUrl":"https://disqus.com/by/s_bastien_le_gall/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"284562996","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/s_bastien_le_gall.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/s_bastien_le_gall.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/s_bastien_le_gall.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Hi Olivier. Very Nice blog. If Mnist had thousands of classes instead of 10. Have you thought how to modify your code to be sure that you have multiple image of same class in a each single batch. I am asking this question because I would like to implement triplet loss with database of more than 10 thousands of classes.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-04-11T18:26:03","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>Fair point, it's definitely something I'll add when I have some time.\u003cbr>I guess the easiest approach would be to create a tf.data.Dataset from a generator giving batches of filenames / labels. The job of the generator would be to give a batch containing P different classes with K images each (total batch size is PK).\u003c/p>","id":"3839118559","createdAt":"2018-04-04T18:26:03","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":3838943932,"isApproved":true,"isFlagged":false,"raw_message":"Fair point, it's definitely something I'll add when I have some time.\nI guess the easiest approach would be to create a tf.data.Dataset from a generator giving batches of filenames / labels. The job of the generator would be to give a batch containing P different classes with K images each (total batch size is PK).","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":1,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-04-11T14:09:58","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>Very nice post, thanks for it! From my perspective it was always easier to implement such ideas in ex. PyTorch. But look like TensorFlow code also looks nice!\u003c/p>","id":"3838699533","createdAt":"2018-04-04T14:09:58","author":{"username":"bartoszludwiczuk","about":"","name":"Bartosz Ludwiczuk","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-10-25T08:00:55","profileUrl":"https://disqus.com/by/bartoszludwiczuk/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"227699081","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/bartoszludwiczuk.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/bartoszludwiczuk.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/bartoszludwiczuk.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Very nice post, thanks for it! From my perspective it was always easier to implement such ideas in ex. PyTorch. But look like TensorFlow code also looks nice!","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-04-11T14:42:58","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>I think PyTorch sometimes hides the details of what happens, so the computation might switch unexpectedly from the GPU to the CPU at some point (when computing the loss). I don't know much about PyTorch so it's just a guess !\u003c/p>\u003cp>Thanks for your blog posts and your work on OpenFace :)\u003c/p>","id":"3838749045","createdAt":"2018-04-04T14:42:58","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":3838699533,"isApproved":true,"isFlagged":false,"raw_message":"I think PyTorch sometimes hides the details of what happens, so the computation might switch unexpectedly from the GPU to the CPU at some point (when computing the loss). I don't know much about PyTorch so it's just a guess !\n\nThanks for your blog posts and your work on OpenFace :)","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":1,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-09-29T11:08:08","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>You should try it out, it really doesn't \"switch devices unexpectedly\" as you describe ;) nice blog post.\u003c/p>","id":"4108426748","createdAt":"2018-09-22T11:08:08","author":{"username":"bermanmaxim","about":"","name":"Max","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2015-01-13T13:46:50","profileUrl":"https://disqus.com/by/bermanmaxim/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"139243480","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/bermanmaxim.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/bermanmaxim.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/bermanmaxim.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":3838749045,"isApproved":true,"isFlagged":false,"raw_message":"You should try it out, it really doesn't \"switch devices unexpectedly\" as you describe ;) nice blog post.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":2,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-04-03T14:13:25","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>I changed triplet_strategy in params.json file to batch_hard, and found that the loss was always 0.5?\u003c/p>\u003cp>Why? batch_all is ok.\u003c/p>\u003cp>Thanks!\u003c/p>","id":"3826589716","createdAt":"2018-03-27T14:13:25","author":{"username":"s5plus1","about":"","name":"s5plus1","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2018-03-27T14:11:32","profileUrl":"https://disqus.com/by/s5plus1/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"283875035","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/s5plus1.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/s5plus1.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/s5plus1.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"I changed triplet_strategy in params.json file to batch_hard, and found that the loss was always 0.5?\n\nWhy? batch_all is ok.\n\nThanks!","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2018-04-04T20:58:47","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>Very good point ! The issue here is that as described in the post, the batch hard loss is a bit more unstable so with the default learning rate I gave (1e-3), it looks like all the embeddings collapse to a single point.\u003cbr>So if all embeddings are collapsed, the loss will always be equal to the margin (all distances are 0).\u003c/p>\u003cp>With lower learning rates (1e-4 or 3e-4), this doesn't happen and the network can learn correctly.\u003cbr>I noticed that the \"batch all\" strategy is more stable since learning rates of 1e-3 or 3e-3 still converge with it.\u003c/p>","id":"3828918549","createdAt":"2018-03-28T20:58:47","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":3826589716,"isApproved":true,"isFlagged":false,"raw_message":"Very good point ! The issue here is that as described in the post, the batch hard loss is a bit more unstable so with the default learning rate I gave (1e-3), it looks like all the embeddings collapse to a single point.\nSo if all embeddings are collapsed, the loss will always be equal to the margin (all distances are 0).\n\nWith lower learning rates (1e-4 or 3e-4), this doesn't happen and the network can learn correctly.\nI noticed that the \"batch all\" strategy is more stable since learning rates of 1e-3 or 3e-3 still converge with it.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":1,"points":1,"moderationLabels":[],"isEdited":true,"sb":false},{"editableUntil":"2018-04-05T02:35:11","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>Lower lr works.\u003c/p>\u003cp>Thanks for your reply!\u003c/p>","id":"3829289998","createdAt":"2018-03-29T02:35:11","author":{"username":"s5plus1","about":"","name":"s5plus1","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2018-03-27T14:11:32","profileUrl":"https://disqus.com/by/s5plus1/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"283875035","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/s5plus1.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/s5plus1.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/s5plus1.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":3828918549,"isApproved":true,"isFlagged":false,"raw_message":"Lower lr works. \n\nThanks for your reply!","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":2,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2020-08-17T06:13:43","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>Hi,\u003cbr>Thank you for this great explanation. \u003cbr>I liked the way that you did the Matrix multiplication and broadcasting. \u003cbr>could you please guide me to resources/books to teach me this kind of advance  Matrix multiplication and broadcasting. \u003cbr>I know  Matrix multiplication and broadcasting but in basic level, I mean it never would crossed my mind to do that broadcasting like you did. Thank you.\u003c/p>","id":"5024569045","createdAt":"2020-08-10T06:13:43","author":{"username":"omertusson","about":"","name":"omer tusson","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2014-04-27T10:06:54","profileUrl":"https://disqus.com/by/omertusson/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"104815482","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/omertusson.jpg","cache":"https://c.disquscdn.com/uploads/users/10481/5482/avatar32.jpg?1462610850"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/omertusson.jpg","cache":"https://c.disquscdn.com/uploads/users/10481/5482/avatar92.jpg?1462610850","large":{"permalink":"https://disqus.com/api/users/avatars/omertusson.jpg","cache":"https://c.disquscdn.com/uploads/users/10481/5482/avatar92.jpg?1462610850"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Hi,\nThank you for this great explanation. \nI liked the way that you did the Matrix multiplication and broadcasting. \ncould you please guide me to resources/books to teach me this kind of advance  Matrix multiplication and broadcasting. \nI know  Matrix multiplication and broadcasting but in basic level, I mean it never would crossed my mind to do that broadcasting like you did. Thank you.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":0,"moderationLabels":[],"isEdited":true,"sb":false},{"editableUntil":"2020-06-13T19:29:42","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>Fantastic post.  This is the clearest explanation of online triplet mining that I've found, and it was surprisingly easy to port your tensorflow code to PyTorch.  Beautiful.  Many thanks!\u003c/p>","id":"4943675213","createdAt":"2020-06-06T19:29:42","author":{"username":"adam_bendorf","about":"","name":"Adam Bendorf","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2020-06-06T19:28:13","profileUrl":"https://disqus.com/by/adam_bendorf/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"350838772","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adam_bendorf.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adam_bendorf.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adam_bendorf.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Fantastic post.  This is the clearest explanation of online triplet mining that I've found, and it was surprisingly easy to port your tensorflow code to PyTorch.  Beautiful.  Many thanks!","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2020-05-07T04:42:21","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>Never thought of using diagonal to get L2 norms. This blog post is an absolute beauty. Thank you so much man :)\u003c/p>","id":"4895428355","createdAt":"2020-04-30T04:42:21","author":{"username":"sayak_paul","about":"Deep Learning Associate at PyImageSearch","name":"Sayak Paul","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2016-07-15T18:10:04","profileUrl":"https://disqus.com/by/sayak_paul/","url":"https://www.sayak.dev","location":"India","isPrivate":true,"signedUrl":"https://disq.us/?url=https%3A%2F%2Fwww.sayak.dev&key=gVoA95Hqor-48US8kL79mQ","isPrimary":true,"isAnonymous":false,"id":"215210956","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/sayak_paul.jpg","cache":"https://c.disquscdn.com/uploads/users/21521/956/avatar32.jpg?1567181356"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/sayak_paul.jpg","cache":"https://c.disquscdn.com/uploads/users/21521/956/avatar92.jpg?1567181356","large":{"permalink":"https://disqus.com/api/users/avatars/sayak_paul.jpg","cache":"https://c.disquscdn.com/uploads/users/21521/956/avatar92.jpg?1567181356"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Never thought of using diagonal to get L2 norms. This blog post is an absolute beauty. Thank you so much man :)","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2019-10-28T20:10:19","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>Thanks for this informative post,\u003c/p>\u003cp>I had a doubt regarding a problem that I have. I am working on a classification problem with 120 classes and so, I would need very high batch-sizes, 1000 maybe to get good triplets. I am not having powerful GPUs and my RAM is not large too. In this scenario, should I get the triplets from all over the dataset rather than restricting myself to only the batch? Will it give me competitive results?\u003c/p>","id":"4660716542","createdAt":"2019-10-21T20:10:19","author":{"username":"anirudhthatipelli","about":"","name":"Anirudh thatipelli","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2017-12-30T05:09:17","profileUrl":"https://disqus.com/by/anirudhthatipelli/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"275466317","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/anirudhthatipelli.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/anirudhthatipelli.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/anirudhthatipelli.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Thanks for this informative post,\n \n \nI had a doubt regarding a problem that I have. I am working on a classification problem with 120 classes and so, I would need very high batch-sizes, 1000 maybe to get good triplets. I am not having powerful GPUs and my RAM is not large too. In this scenario, should I get the triplets from all over the dataset rather than restricting myself to only the batch? Will it give me competitive results?","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2019-09-13T14:58:38","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>Great post Oliver!\u003c/p>\u003cp>I am having trouble understanding one thing, related to the method _get_anchor_positive_triplet_mask.\u003cbr>Suppose you have 4 points (&lt;point&gt;, &lt;label&gt;, &lt;coords&gt;) in a 2-D space:\u003cbr>(A, 1, [4, 3])\u003cbr>(B, 2, [2, 7])\u003cbr>(C, 3, [11, 10])\u003cbr>(D, 1, [9, 6])\u003c/p>\u003cp>The valid triplets (&lt;anchor&gt;, &lt;positive&gt;, &lt;negative&gt;) would be:\u003cbr>(A, D, B)\u003cbr>(A, D, C)\u003cbr>(D, A, B)\u003cbr>(D, A, C)\u003c/p>\u003cp>The hardest triplets are:\u003cbr>(A, D, B) (B is closer to A, compared to C)\u003cbr>(D, A, C) (C is closer to D, compared to B)\u003c/p>\u003cp>Following the batch_hard (L_BH) from the paper that you referenced (Hermans et al.),\u003cbr>the L_BH of this batch would be:\u003cbr>(margin + d(A, D) - d(A, B)) +\u003cbr>(margin + d(D, A) - d(D, C))\u003c/p>\u003cp>Right?\u003c/p>\u003cp>But when I compute the L_BH presented above, I get a different value from your implementation batch_hard_triplet_loss.\u003cbr>Is my assumption of the L_BH wrong?\u003c/p>\u003cp>Thank you in advance.\u003c/p>","id":"4606593310","createdAt":"2019-09-06T14:58:38","author":{"username":"disqus_tMmtS86MM5","about":"","name":"Seb P","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2019-09-06T14:45:45","profileUrl":"https://disqus.com/by/disqus_tMmtS86MM5/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"337446175","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_tMmtS86MM5.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_tMmtS86MM5.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_tMmtS86MM5.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Great post Oliver!\n\nI am having trouble understanding one thing, related to the method _get_anchor_positive_triplet_mask.\nSuppose you have 4 points (\u003cpoint>, \u003clabel>, \u003ccoords>) in a 2-D space:\n(A, 1, [4, 3])\n(B, 2, [2, 7])\n(C, 3, [11, 10])\n(D, 1, [9, 6])\n\nThe valid triplets (\u003canchor>, \u003cpositive>, \u003cnegative>) would be:\n(A, D, B)\n(A, D, C)\n(D, A, B)\n(D, A, C)\n\nThe hardest triplets are:\n(A, D, B) (B is closer to A, compared to C)\n(D, A, C) (C is closer to D, compared to B)\n\nFollowing the batch_hard (L_BH) from the paper that you referenced (Hermans et al.),\nthe L_BH of this batch would be:\n(margin + d(A, D) - d(A, B)) +\n(margin + d(D, A) - d(D, C))\n\nRight?\n\nBut when I compute the L_BH presented above, I get a different value from your implementation batch_hard_triplet_loss.\nIs my assumption of the L_BH wrong?\n\nThank you in advance.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2019-09-16T12:15:47","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>I know why this happened. When you calculate the hardest minimum, you do tf.reduce_max, when you should be looking for the argmin (the closest negative). Hope I'm right :)\u003c/p>","id":"4609595701","createdAt":"2019-09-09T12:15:47","author":{"username":"disqus_tMmtS86MM5","about":"","name":"Seb P","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2019-09-06T14:45:45","profileUrl":"https://disqus.com/by/disqus_tMmtS86MM5/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"337446175","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_tMmtS86MM5.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_tMmtS86MM5.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_tMmtS86MM5.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4606593310,"isApproved":true,"isFlagged":false,"raw_message":"I know why this happened. When you calculate the hardest minimum, you do tf.reduce_max, when you should be looking for the argmin (the closest negative). Hope I'm right :)","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":1,"points":1,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2019-09-22T18:11:12","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>Could you give more information on the exact location of the bug you found?\u003c/p>","id":"4616851052","createdAt":"2019-09-15T18:11:12","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4609595701,"isApproved":true,"isFlagged":false,"raw_message":"Could you give more information on the exact location of the bug you found?","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":2,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2019-09-23T09:58:53","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>Hi \u003ca data-dsq-mention=\"oliviermoindrot:disqus\" href=\"https://disqus.com/by/oliviermoindrot/\" rel=\"nofollow noopener\" title=\"https://disqus.com/by/oliviermoindrot/\">Olivier Moindrot\u003c/a>    .\u003cbr>I'm so sorry, there is no bug. I misinterpreted the code... But the batch_hard_triplet_loss that you implemented is yielding a different value from the expression on the paper In Defense of the Triplet Loss for Person Re-Identification, following my calculations, regarding the example that I wrote on my first comment.\u003cbr>In my example, the two hardest triplets (&lt;anchor&gt;, &lt;positive&gt;, &lt;negative&gt;) are: (A, D, B) and (D, A, C). If the margin is 1, shouldn't the hard triplet loss be:\u003cbr>(1 + d(A, D) - d(A, B)) + (1 + d(D, A) - d(D, C))? \u003cbr>Thank you, and sorry again for my misinterpretation...\u003c/p>","id":"4617499454","createdAt":"2019-09-16T09:58:53","author":{"username":"disqus_tMmtS86MM5","about":"","name":"Seb P","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2019-09-06T14:45:45","profileUrl":"https://disqus.com/by/disqus_tMmtS86MM5/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"337446175","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_tMmtS86MM5.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_tMmtS86MM5.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_tMmtS86MM5.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4616851052,"isApproved":true,"isFlagged":false,"raw_message":"Hi @oliviermoindrot:disqus    .\nI'm so sorry, there is no bug. I misinterpreted the code... But the batch_hard_triplet_loss that you implemented is yielding a different value from the expression on the paper In Defense of the Triplet Loss for Person Re-Identification, following my calculations, regarding the example that I wrote on my first comment.\nIn my example, the two hardest triplets (\u003canchor>, \u003cpositive>, \u003cnegative>) are: (A, D, B) and (D, A, C). If the margin is 1, shouldn't the hard triplet loss be:\n(1 + d(A, D) - d(A, B)) + (1 + d(D, A) - d(D, C))? \nThank you, and sorry again for my misinterpretation...","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":3,"points":0,"moderationLabels":[],"isEdited":false,"sb":false},{"editableUntil":"2019-07-30T13:24:55","dislikes":0,"thread":"6564336423","numReports":0,"likes":0,"message":"\u003cp>Hi \u003ca data-dsq-mention=\"oliviermoindrot:disqus\" href=\"https://disqus.com/by/oliviermoindrot/\" rel=\"nofollow noopener\" title=\"https://disqus.com/by/oliviermoindrot/\">Olivier Moindrot\u003c/a>  I find your post quite helpful in understanding the implementation of triplet loss function. I want to ask you that I wish to train a face recognition model on a data-set which doesn't contain human images, so what model do you suggest me to use here?\u003c/p>\u003cp>Also, any suggestion for triplet loss hyperparameter based on the size of dataset?\u003c/p>","id":"4550312552","createdAt":"2019-07-23T13:24:55","author":{"username":"disqus_5PwfaXWpZy","about":"","name":"Karan Sharma","disable3rdPartyTrackers":false,"isPowerContributor":false,"joinedAt":"2019-07-23T13:24:43","profileUrl":"https://disqus.com/by/disqus_5PwfaXWpZy/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"335339188","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_5PwfaXWpZy.jpg","cache":"https://c.disquscdn.com/uploads/users/33533/9188/avatar32.jpg?1566196537"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_5PwfaXWpZy.jpg","cache":"https://c.disquscdn.com/uploads/users/33533/9188/avatar92.jpg?1566196537","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_5PwfaXWpZy.jpg","cache":"https://c.disquscdn.com/uploads/users/33533/9188/avatar92.jpg?1566196537"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":null,"isApproved":true,"isFlagged":false,"raw_message":"Hi @oliviermoindrot:disqus  I find your post quite helpful in understanding the implementation of triplet loss function. I want to ask you that I wish to train a face recognition model on a data-set which doesn't contain human images, so what model do you suggest me to use here? \n\nAlso, any suggestion for triplet loss hyperparameter based on the size of dataset?","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":0,"points":0,"moderationLabels":[],"isEdited":true,"sb":false},{"editableUntil":"2019-08-09T15:53:42","dislikes":0,"thread":"6564336423","numReports":0,"likes":1,"message":"\u003cp>I'm not sure what you mean by face recognition without human images (maybe it's on animals?), but the idea stays the same: the triplet loss will bring together examples from the same identity and separate examples from different identities.\u003c/p>\u003cp>For the parameters, I would start with a low learning rate and closely watch metrics to see how the embeddings are improving. The margin doesn't seem to have a very big impact.\u003c/p>","id":"4563291879","createdAt":"2019-08-02T15:53:42","author":{"username":"oliviermoindrot","about":"","name":"Olivier Moindrot","disable3rdPartyTrackers":true,"isPowerContributor":false,"joinedAt":"2016-11-29T01:41:26","profileUrl":"https://disqus.com/by/oliviermoindrot/","url":"","location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"isAnonymous":false,"id":"232266951","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/oliviermoindrot.jpg","cache":"//a.disquscdn.com/1595026414/images/noavatar92.png"}}},"media":[],"isSpam":false,"hasMore":false,"isDeleted":false,"isDeletedByAuthor":false,"parent":4550312552,"isApproved":true,"isFlagged":false,"raw_message":"I'm not sure what you mean by face recognition without human images (maybe it's on animals?), but the idea stays the same: the triplet loss will bring together examples from the same identity and separate examples from different identities.\n\nFor the parameters, I would start with a low learning rate and closely watch metrics to see how the embeddings are improving. The margin doesn't seem to have a very big impact.","isAtFlagLimit":false,"isHighlighted":false,"canVote":false,"forum":"omoindrot-github-io","depth":1,"points":1,"moderationLabels":[],"isEdited":false,"sb":false}],"thread":{"feed":"https://omoindrot-github-io.disqus.com/triplet_loss_and_online_triplet_mining_in_tensorflow/latest.rss","clean_title":"Triplet Loss and Online Triplet Mining in TensorFlow","dislikes":0,"likes":40,"message":"","ratingsEnabled":false,"isSpam":false,"isDeleted":false,"category":"6848328","adsDisabled":false,"author":"232266951","id":"6564336423","signedLink":"https://disq.us/?url=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&key=CB7Ri2nkaDzCFKLo911sng","createdAt":"2018-03-20T04:11:17","hasStreaming":false,"raw_message":"","isClosed":false,"link":"https://omoindrot.github.io/triplet-loss","slug":"triplet_loss_and_online_triplet_mining_in_tensorflow","forum":"omoindrot-github-io","identifiers":["https://omoindrot.github.io/triplet-loss"],"posts":119,"moderators":[232266951],"validateAllPosts":false,"title":"Triplet Loss and Online Triplet Mining in TensorFlow","highlightedPost":null}},"order":"popular"}</script>


    <div id="fixed-content"></div>


    
        
            
<script type="text/json" id="disqus-urls">{
    "root":"//disqus.com",
    "next":"https://c.disquscdn.com/next/current/embed"
}</script>

        
        
        <script>!function () {
            var d = document;
            var toH = d.head.appendChild.bind(d.head);

            var v = window.location.href.match(/[#&?]version=([0-9a-f]{32})/);
            var src = 'https://c.disquscdn.com/next/embed/lounge.load';
            if (v)
                src += '.' + v[1];
            src += '.js';

            var s = d.createElement('script');
            s.crossOrigin = 'anonymous';
            s.id = 'bootstrap-script';
            s.setAttribute('data-app', 'lounge');
            s.src = src;
            toH(s);

            var m = d.createElement('meta');
            m.setAttribute('http-equiv', 'Content-Security-Policy');
            m.setAttribute('content', "script-src https:;");
            toH(m);
        }();</script>
    


<script src="./common.bundle.9061cdaed1273d430eb02357766a8560.js"></script><div id="layout" data-tracking-area="layout"><div id="thread__container"><div><div id="thread__wrapper"><div id="placement-top" data-tracking-area="discovery-north"><div class="post-list" style="height: 0px; visibility: hidden;"></div></div><div id="lightbox__container"></div><div id="onboard" data-tracking-area="onboard"></div><div id="reactions__container"></div><div id="ratings__container"></div><div id="highlighted-post" data-tracking-area="highlighted" class="highlighted-post" style="display: none;"></div><div id="global-alert"></div><div id="tos__container"></div><header id="main-nav" data-tracking-area="main-nav"><nav class="nav nav-primary"><ul><li class="nav-tab nav-tab--primary tab-conversation active" data-role="post-count"><a class="publisher-nav-color"><span class="comment-count">119 comments</span><span class="comment-count-placeholder">Comments</span></a></li><li class="nav-tab nav-tab--primary tab-general"><a href="https://disqus.com/home/forums/omoindrot-github-io/" class="publisher-nav-color" data-action="community-sidebar" data-forum="omoindrot-github-io" id="community-tab" name="omoindrot.github.io"><span class="community-name"><strong>omoindrot.github.io</strong></span><strong class="community-name-placeholder">Community</strong></a></li><li class="nav-tab nav-tab--primary tab-general"><a href="https://help.disqus.com/customer/portal/articles/466259-privacy-policy" rel="nofollow noopener noreferrer" target="_blank" class="publisher-nav-color privacy-policy" title="Disqus&#39; Privacy Policy"><i aria-hidden="true" class="icon icon-lock"></i><span class="clip privacy-policy-full hidden-md">&nbsp;Disqus' Privacy Policy</span><span class="clip privacy-policy-short">&nbsp;Privacy Policy</span></a></li><li class="nav-tab nav-tab--primary dropdown user-menu media-collapsed" data-role="logout"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="dropdown-toggle" data-toggle="dropdown" role="menuitem" name="Login"><span class="dropdown-toggle-wrapper"><span>Login</span> </span> <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="auth:disqus">Disqus</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="auth:facebook">Facebook</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="auth:twitter">Twitter</a></li><li><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="auth:google">Google</a></li></ul></li><li class="nav-tab nav-tab--primary notification-menu unread" data-role="notification-menu" style="display: list-item;"><a href="https://disqus.com/home/inbox/" class="notification-container" data-action="home" data-home-path="home/inbox/"><span class="notification-icon icon-comment" aria-hidden="true"></span><span class="notification-count" data-role="notification-count">1</span></a></li></ul></nav></header><section id="conversation" data-role="main" data-tracking-area="main"><div class="nav nav-secondary" data-tracking-area="secondary-nav"><ul><li id="recommend-button" class="nav-tab nav-tab--secondary recommend dropdown"><div class="thread-likes"><div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="recommend" title="Recommend this discussion" class="dropdown-toggle "><span class="label label-default"><span class="recommend-icon icon-heart-empty"></span> Recommend</span><span class="label label-recommended"><span class="recommend-icon icon-heart"></span> Recommended</span> <span class="label label-count">40</span></a><ul class="dropdown-menu dropdown-menu--coachmark"><li><div><h2 class="coachmark__heading">Discussion Recommended!</h2><p class="coachmark__description">Recommending means this is a discussion worth sharing. It gets shared to your followers' Disqus feeds, and gives the creator kudos!</p></div> <a href="https://disqus.com/home/?utm_source=disqus_embed&amp;utm_content=recommend_btn" class="btn btn-primary coachmark__button" target="_blank">Find More Discussions</a></li></ul></div></div></li><li id="thread-share-bar" class="nav-tab nav-tab--secondary share-bar hidden-sm"><div class="thread-share-bar-buttons"><span class="thread-share__button share-twitter" data-action="share:twitter" tabindex="0"><span class="icon-twitter"></span><span class="share-text">Tweet</span></span><span class="thread-share__button share-facebook" data-action="share:facebook" tabindex="0"><span class="icon-facebook"></span><span class="share-text">Share</span></span></div></li><li data-role="post-sort" class="nav-tab nav-tab--secondary dropdown sorting pull-right"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="dropdown-toggle" data-toggle="dropdown">Sort by Best<span class="caret"></span></a><ul class="dropdown-menu pull-right"><li class="selected"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="sort" data-sort="popular">Best<i aria-hidden="true" class="icon-checkmark"></i></a></li><li class=""><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="sort" data-sort="desc">Newest<i aria-hidden="true" class="icon-checkmark"></i></a></li><li class=""><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="sort" data-sort="asc">Oldest<i aria-hidden="true" class="icon-checkmark"></i></a></li></ul></li></ul></div><div id="posts"><div id="form" class="textarea-outer-wrapper--top-level"><form class="reply"><div class="postbox"><div role="alert"></div><div class="ratings-wrapper" data-role="ratings-container"></div><div class="compose-wrapper"><div class="avatar"><span class="user"><img data-role="user-avatar" src="./noavatar92.png" alt="Avatar"></span></div><div class="textarea-outer-wrapper"><div class="textarea-wrapper" data-role="textarea" dir="auto"><div><span class="placeholder">Join the discussion</span><div class="textarea" tabindex="0" role="textbox" aria-multiline="true" contenteditable="PLAINTEXT-ONLY" data-role="editable" aria-label="Join the discussion" style="overflow: auto; overflow-wrap: break-word; max-height: 350px;"><p><br></p></div><div style="display: none;"><ul class="user-mention__list" id="user-mention-list"><li class="header user-mention__header"><h5>in this conversation</h5></li></ul></div></div><div data-role="drag-drop-placeholder" class="media-drag-hover" style="display: none;"><div class="drag-text"> Drag and drop your images here to upload them.</div></div><div class="media-preview empty" data-role="media-preview"><ul data-role="media-progress-list"></ul>
<ul data-role="media-rich-list"></ul>
<div class="media-expanded empty" data-role="media-preview-expanded">
<img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-role="media-preview-expanded-image" alt="Media preview placeholder">
</div>
</div><div class="edit-alert" role="postbox-alert"></div><div class="text-editor-container"><div class="post-actions"><div class="wysiwyg"><div class="gif-picker"><div class="wysiwyg__item" data-role="gif-picker-toggle" title="GIF"><div class="wysiwyg__gif" title="GIF" role="img" aria-label="GIF"></div></div><div class="hidden gif-picker__popout-container" data-role="gif-picker-popout-container"></div><div class="new-feature-badge-star" title="New"><div class="wysiwyg__star-badge wysiwyg__star-badge-dims"></div></div></div><div class="media-uploader"><li class="wysiwyg__item" data-role="media-uploader"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" tabindex="-1" data-action="attach" class="attach" title="Upload Images">
<div class="wysiwyg__attach wysiwyg__attach-dims" role="img" aria-label="A"></div>
</a>
<input type="file" data-role="media-upload" tabindex="-1" accept="image/*">
</li></div><div class="vertical-separator"></div><div data-action="text-editor-buttons"><div class="wysiwyg__item" data-action="text-editor-tag" data-tag="b"><div class="wysiwyg__bold" title="Bold" role="img" aria-label="B"></div></div><div class="wysiwyg__item" data-action="text-editor-tag" data-tag="i"><div class="wysiwyg__italic" title="Italic" role="img" aria-label="I"></div></div><div class="wysiwyg__item" data-action="text-editor-tag" data-tag="u"><div class="wysiwyg__underline" title="Underline" role="img" aria-label="U"></div></div><div class="wysiwyg__item" data-action="text-editor-tag" data-tag="s"><div class="wysiwyg__strikethrough" title="Strikethrough" role="img" aria-label="S"></div></div><div class="wysiwyg__item" data-action="text-editor-tag" data-tag="a"><div class="wysiwyg__link" title="Link" role="img" aria-label="L"></div></div><div class="wysiwyg__item" data-action="text-editor-tag" data-tag="spoiler"><div class="wysiwyg__spoiler" title="Spoiler" role="img" aria-label="Sp"></div></div><div class="wysiwyg__item" data-action="text-editor-tag" data-tag="code"><div class="wysiwyg__code" title="Code" role="img" aria-label="C"></div></div><div class="wysiwyg__item" data-action="text-editor-tag" data-tag="blockquote"><div class="wysiwyg__blockquote" title="Quote" role="img" aria-label="Q"></div></div></div></div><div class="logged-in"><section><div class="temp-post"><button class="btn post-action__button full-size-button hidden">Post as <span data-role="username"></span></button><button class="btn post-action__button small-size-button hidden">Post</button></div></section></div></div></div></div></div></div><div data-role="login-form"><div><div><section class="auth-section logged-out__display"><div class="connect"><h6>Log in with</h6><ul data-role="login-menu" class="services login-buttons"><li class="auth-disqus"><button type="button" data-action="auth:disqus" title="Disqus" class="connect__button"><i class="icon-disqus"></i></button></li><li class="auth-facebook"><button type="button" data-action="auth:facebook" title="Facebook" class="connect__button"><i class="icon-facebook-circle"></i></button></li><li class="auth-twitter"><button type="button" data-action="auth:twitter" title="Twitter" class="connect__button"><i class="icon-twitter-circle"></i></button></li><li class="auth-google"><button type="button" data-action="auth:google" title="Google" class="connect__button"><i class="icon-google-plus-circle"></i></button></li></ul></div><div class="guest"><h6 class="guest-form-title"><span class="register-text"> or sign up with Disqus </span><span class="guest-text"> or pick a name </span></h6> <div class="help-tooltip__wrapper help-icon" tabindex="0"><div id="rules" class="tooltip show help-tooltip"><h3 class="help-tooltip__heading">Disqus is a discussion network</h3><ul class="help-tooltip__list"><li><span>Disqus never moderates or censors. The rules on this community are its own.</span></li><li><span>Don't be a jerk or do anything illegal. Everything is easier that way.</span></li></ul><p class="clearfix"><a href="https://docs.disqus.com/kb/terms-and-policies/" class="btn btn-small help-tooltip__button" target="_blank">Read full terms and conditions</a></p></div></div><p class="input-wrapper"><input dir="auto" type="text" placeholder="Name" name="display_name" id="view108_display_name" maxlength="30" class="input--text" aria-label="name"></p><div class="guest-details " data-role="guest-details"><p class="input-wrapper"><input dir="auto" type="email" placeholder="Email" name="email" id="view108_email" class="input--text" aria-label="email"></p><p class="input-wrapper"><input dir="auto" disabled="" type="text" class="register-text input--text" placeholder="Password" name="password" aria-label="password" id="view108_password"></p><div class="acceptance-wrapper"><p><label><input type="checkbox" name="tos"><span class="spacing-left-small">I agree to Disqus' <a href="https://help.disqus.com/customer/portal/articles/466260-terms-of-service" target="_blank" rel="noopener noreferrer">Terms of Service</a></span></label></p><p><label><input type="checkbox" name="privacy-policy"><span class="spacing-left-small">I agree to Disqus' processing of email and IP address, and the use of cookies, to facilitate my authentication and posting of comments, explained further in the <a href="https://help.disqus.com/customer/portal/articles/466259-privacy-policy" target="_blank" rel="noopener noreferrer">Privacy Policy</a></span></label></p><p><label><input type="checkbox" name="data-sharing"><span class="spacing-left-small">I agree to additional processing of my information, including first and third party cookies, for personalized content and advertising as outlined in our <a href="https://disqus.com/data-sharing-settings/">Data Sharing Policy</a></span></label></p></div><input type="checkbox" name="author-guest" style="display: none;"><div class="g-recaptcha" data-role="grecaptcha-container"></div><div class="proceed" data-role="submit-btn-container"><button type="submit" class="proceed__button btn submit" aria-label="Next" disabled="disabled"><span class="icon-proceed"></span><div class="spinner"></div></button></div></div></div></section></div></div></div></div></form></div><button class="alert alert--realtime" data-role="realtime-notification" style="display: none;"></button><div id="email-signup"></div><div id="no-posts" style="display: none;"></div><ul id="post-list" class="post-list"><li class="post" id="post-4195994592"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4195994592"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/simonbernhard/" data-action="profile" data-username="simonbernhard" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="195165794" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/simonbernhard/" data-action="profile" data-username="simonbernhard" target="_blank" rel="noopener noreferrer">Simon Bernhard</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4195994592" data-role="relative-time" class="time-ago" title="Thursday, November 15, 2018 11:06 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Man, the way you use matrix multiplication and broadcasting here seems absolutely beautiful to me. It was really a massive pleasure to read this post!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-5" data-action="upvote" title="" name="Vote up" data-tid="2596"><span class="updatable count" data-role="likes">5</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1xe6q5c" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4195994592"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4196116023"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4196116023"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4195994592" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Simon Bernhard</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4196116023" data-role="relative-time" class="time-ago" title="Thursday, November 15, 2018 11:55 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thank you, finally someone sees the beauty in it !</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1xe9buf" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4196116023"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4196116023-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4195994592-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-3982124794"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3982124794"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/bkhmsi/" data-action="profile" data-username="bkhmsi" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="119505227" src="./avatar92.jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/bkhmsi/" data-action="profile" data-username="bkhmsi" target="_blank" rel="noopener noreferrer">Badr AlKhamissi</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3982124794" data-role="relative-time" class="time-ago" title="Tuesday, July 10, 2018 6:01 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thank you <a data-dsq-mention="oliviermoindrot:disqus" href="https://disqus.com/by/oliviermoindrot/" rel="nofollow noopener" title="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" class="mention">Olivier Moindrot</a> for your post. It really helped me with my project. Just one note, I edited the batch hard loss function, so for each anchor, I select the hardest k positives and hardest k negatives, which got me better results for my problem, than just using the hardest +ve and -ve.</p><p>Hope that help others as well!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-2" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">2</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1tuur5m" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3982124794"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3983917460"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3983917460"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-3982124794" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Badr AlKhamissi</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3983917460" data-role="relative-time" class="time-ago" title="Wednesday, July 11, 2018 6:15 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>You're right it's definitely possible to take the hardest k, and as you increase k it will look more and more like the batch all strategy.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1tvx6dw" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3983917460"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3983917460-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3982124794-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-3822922583"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3822922583"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/cc_ss/" data-action="profile" data-username="cc_ss" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="283665762" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/cc_ss/" data-action="profile" data-username="cc_ss" target="_blank" rel="noopener noreferrer">cc ss</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3822922583" data-role="relative-time" class="time-ago" title="Sunday, March 25, 2018 5:24 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>"However, we dont want to push the train embeddings of each label to collapse into very small clusters."</p><p>Why not? More recent papers such as SphereFace are trying to do so.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-2" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">2</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1r82hxz" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3822922583"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3823879226"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3823879226"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-3822922583" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> cc ss</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3823879226" data-role="relative-time" class="time-ago" title="Sunday, March 25, 2018 9:13 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>When I mentioned that I meant that if you want to do classification or any task based on the embeddings, you only need the intra-cluster distance to be smaller than the inter-cluster distance. If you have that, then two examples from the same class will always have their embeddings closer than two examples from different classes.<br>Once this is done, you don't really need to push the clusters closer together. My intuition is that if you do so, it's a form of overfitting and you will lose in test accuracy.</p><p>In SphereFace they do something similar to softmax. Softmax is also going to push the predictions as close to 0 or to 1 as possible, which is to me a form of overfitting.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1r8n03e" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3823879226"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3837669444"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3837669444"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_knPjPMDHhO/" data-action="profile" data-username="disqus_knPjPMDHhO" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="217518914" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_knPjPMDHhO/" data-action="profile" data-username="disqus_knPjPMDHhO" target="_blank" rel="noopener noreferrer">Trevor</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-3823879226" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3837669444" data-role="relative-time" class="time-ago" title="Tuesday, April 3, 2018 10:50 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>What if you just use the square of the distance between two points? The gradient will decay the closer the two points are. Which should mean that clusters collapse far slower. There is something awkward with the proposed method of triplet loss, the margin is artificial and points which are close to it may not be well generalized to. Maybe make the margin dynamic somehow?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1rgukp0" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3837669444"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3837804786"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3837804786"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-3837669444" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Trevor</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3837804786" data-role="relative-time" class="time-ago" title="Wednesday, April 4, 2018 12:15 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I'm not sure what you mean when you propose to just take the squared distance between two points as the loss. If you refer to contrastive loss, it works but triplet loss is better.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1rgxh4i" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3837804786"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3837804786-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3837669444-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3823879226-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3822922583-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-3980602634"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3980602634"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_zjk7JctwgC/" data-action="profile" data-username="disqus_zjk7JctwgC" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="88801748" src="./avatar92(1).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_zjk7JctwgC/" data-action="profile" data-username="disqus_zjk7JctwgC" target="_blank" rel="noopener noreferrer">Cristian Garcia</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3980602634" data-role="relative-time" class="time-ago" title="Monday, July 9, 2018 7:06 PM">2 years ago</a> <span><span class="bullet time-ago-bullet" aria-hidden="true"></span> <span class="has-edit" data-role="has-edit">edited</span></span></span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Theoretical Question: What if you split the loss in 2 parts:</p><p>loss = max(||d(a, p)||2, margin_p) - min(||d(a, p)||2, margin_n)</p><p>This way you can still learn to bring positives examples together within a margin_p radius or push back negative examples up to a margin_n radius regardless of the specific triplet chosen.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-3" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">3</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-1" data-action="downvote" title="" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">1</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1tty4ne" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3980602634"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3983944498"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3983944498"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-3980602634" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Cristian Garcia</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3983944498" data-role="relative-time" class="time-ago" title="Wednesday, July 11, 2018 6:32 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I think you meant with a "n" in the second term:<br>loss = max( d(a,p), margin_p) - min(d(a, n), margin_n)</p><p>In this case you don't even need triplets and you can just work on pairs of images. If you have a positive pair the loss is:<br>loss = max( d(a,p), margin_p)</p><p>If you have a negative pair the loss is:<br>loss = - min( d(a,n), margin_n)</p><p>This is very similar to the contrastive loss, you just have an additional parameter for the positive margin here. Triplet loss usually works better according to this paper: <a href="https://disq.us/url?url=https%3A%2F%2Farxiv.org%2Fabs%2F1706.07567%3AhOLb4pkewqIoDvAEmmRUY7CmdGg&amp;cuid=5136996" rel="nofollow noopener" title="https://arxiv.org/abs/1706.07567">https://arxiv.org/abs/1706....</a></p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-2" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">2</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1tvxr8y" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3983944498"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3983944498-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3980602634-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4473507818"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4473507818"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_MPXyUXcLl0/" data-action="profile" data-username="disqus_MPXyUXcLl0" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="233100824" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_MPXyUXcLl0/" data-action="profile" data-username="disqus_MPXyUXcLl0" target="_blank" rel="noopener noreferrer">Sainath Reddy</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4473507818" data-role="relative-time" class="time-ago" title="Thursday, May 23, 2019 9:05 AM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>how to decide the margin value, i mean whatever strategy i use i,e batch all,batch hard the loss of the model is always same and number of true positives is same through out the train. Any pointers and tips should i consider while training or is it the problem of the data.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/21zesq2" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4473507818"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4476191324"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4476191324"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4473507818" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Sainath Reddy</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4476191324" data-role="relative-time" class="time-ago" title="Saturday, May 25, 2019 10:51 AM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Maybe try to decrease the learning rate, since all the embeddings might have collapsed to the same point.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/2210bbw" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4476191324"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4478278782"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4478278782"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_MPXyUXcLl0/" data-action="profile" data-username="disqus_MPXyUXcLl0" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="233100824" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_MPXyUXcLl0/" data-action="profile" data-username="disqus_MPXyUXcLl0" target="_blank" rel="noopener noreferrer">Sainath Reddy</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4476191324" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4478278782" data-role="relative-time" class="time-ago" title="Monday, May 27, 2019 7:09 AM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>yeah i have tried decreasing loss even though the number of true triplets is same through out the training.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/222920u" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4478278782"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4478278782-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4476191324-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4473507818-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4326885409"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4326885409"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_9rpOocX6Tq/" data-action="profile" data-username="disqus_9rpOocX6Tq" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="328572070" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_9rpOocX6Tq/" data-action="profile" data-username="disqus_9rpOocX6Tq" target="_blank" rel="noopener noreferrer"></a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4326885409" data-role="relative-time" class="time-ago" title="Thursday, February 7, 2019 7:27 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi Olivier Moindrot,<br>Thank you for the post! It's really help me.  I am trying to use the triplet loss for my research. There are some questions really bother me for a long time.  Could you help me?<br>The questions are:<br>- How do we compute the accuracy for the results? <br>- Our input is a set (a,p,n). When I want to know if two photos are the same person, I only have two pictures but our model have to input three pictures. How can I do?</p><p>Thanks in advance.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1zk465d" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4326885409"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4349100683"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4349100683"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4326885409" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> </a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4349100683" data-role="relative-time" class="time-ago" title="Friday, February 22, 2019 10:24 AM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>For the second question, if you follow my code then you don't have a set (a, p, n) as input. You have a batch of examples as input, and then you compute the triplet loss online on this batch of examples.</p><p>In any case, you should be able to run your trained model to produce embeddings for each face. You can then compute the cosine distance between faces to see if they match (lower distance = better match).</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1zxcbkb" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4349100683"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4349100683-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4349099726"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4349099726"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4326885409" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> </a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4349099726" data-role="relative-time" class="time-ago" title="Friday, February 22, 2019 10:23 AM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I suppose you are working in face recognition.</p><p>For the evaluation metric, you can use the rank-N metric.<br>For each face in the test set, you compute how much they match with each identity in the training set. This gives you an ordered list of identities (ex: Brad Pitt, Barack Obama...). If the original face was of Barack Obama, the rank of the true label is 2.</p><p>The rank-N metric is the proportion of predictions in the top N for each face in the test set.</p><p>So rank-1 metric is the proportion of faces with correct precision.</p><p>In general you can plot this metric for all rank N = 1, 2, 3... and see how it evolves.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1zxcatq" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4349099726"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4692876641"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4692876641"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/AdamDKlein/" data-action="profile" data-username="AdamDKlein" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="14171729" src="./avatar92(2).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/AdamDKlein/" data-action="profile" data-username="AdamDKlein" target="_blank" rel="noopener noreferrer">AdamDKlein</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4349099726" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4692876641" data-role="relative-time" class="time-ago" title="Sunday, November 17, 2019 7:57 PM">9 months ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi! Thanks so much for this informative post and implementation. To implement rank-1 accuracy, would you use KNN from sklearn? Or maybe you could use pairwise distances excluding the diagonal and just take the min?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/25m0msh" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4692876641"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4763827932"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4763827932"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/emanueloehri/" data-action="profile" data-username="emanueloehri" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="343601307" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/emanueloehri/" data-action="profile" data-username="emanueloehri" target="_blank" rel="noopener noreferrer">eoehri</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4692876641" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> AdamDKlein</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4763827932" data-role="relative-time" class="time-ago" title="Monday, January 20, 2020 11:28 AM">7 months ago</a> <span><span class="bullet time-ago-bullet" aria-hidden="true"></span> <span class="has-edit" data-role="has-edit">edited</span></span></span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi, I'm also interested in evaluating the model with rank-1 accuracy. How did you implement it in the end? Could you even share some code? That would be amazing. Thanks a lot!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/26s9d5o" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4763827932"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4764004187"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4764004187"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/AdamDKlein/" data-action="profile" data-username="AdamDKlein" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="14171729" src="./avatar92(2).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/AdamDKlein/" data-action="profile" data-username="AdamDKlein" target="_blank" rel="noopener noreferrer">AdamDKlein</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4763827932" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> eoehri</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4764004187" data-role="relative-time" class="time-ago" title="Monday, January 20, 2020 3:31 PM">7 months ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I used KNN from sklearn on the test set, as that part is a pretty trivial thing to do. I didn't use it as a training metric.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/26sd55n" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4764004187"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4764004187-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4763827932-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4692876641-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4349099726-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4326885409-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4197901941"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4197901941"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/shakedhiba/" data-action="profile" data-username="shakedhiba" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="325206143" src="./avatar92(3).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/shakedhiba/" data-action="profile" data-username="shakedhiba" target="_blank" rel="noopener noreferrer">Shaked Hiba</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4197901941" data-role="relative-time" class="time-ago" title="Friday, November 16, 2018 12:54 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>is there any specific reason to use _pairwise_distances and not scipy.spatial.distance.pdist?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1xfblv9" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4197901941"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4198024133"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4198024133"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4197901941" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Shaked Hiba</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4198024133" data-role="relative-time" class="time-ago" title="Friday, November 16, 2018 2:42 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Well you have to create everything inside the TensorFlow graph to have gradients and to be able to run backpropagation.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1xfe85h" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4198024133"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4946805975"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4946805975"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_SniTvkrZqx/" data-action="profile" data-username="disqus_SniTvkrZqx" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="217534136" src="./avatar92(4).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_SniTvkrZqx/" data-action="profile" data-username="disqus_SniTvkrZqx" target="_blank" rel="noopener noreferrer">Anil Kumar</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4198024133" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4946805975" data-role="relative-time" class="time-ago" title="Tuesday, June 9, 2020 9:22 AM">2 months ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi Oliver, we can compute the triplets using batch hard or batch all technique outside tensorflow(in python for ex) and design tf graph such that it receives triplets as inputs instead of batch of images. Is there any advantage of keeping triplets creating code inside TF?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/29t77x3" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4946805975"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4946805975-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4198024133-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4197901941-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4179026030"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4179026030"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_Og25rIyjhB/" data-action="profile" data-username="disqus_Og25rIyjhB" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="324686852" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_Og25rIyjhB/" data-action="profile" data-username="disqus_Og25rIyjhB" target="_blank" rel="noopener noreferrer">Deepak Nathani</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4179026030" data-role="relative-time" class="time-ago" title="Monday, November 5, 2018 8:48 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hey Olivier<br>I am trying to implement triplet loss for cross-modality retrieval problem in keras. This blog post saved my day. Thanks a lot.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1x4314e" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4179026030"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4179026030-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4094888102"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4094888102"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/veeranjaneyulutoka/" data-action="profile" data-username="veeranjaneyulutoka" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="250125618" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/veeranjaneyulutoka/" data-action="profile" data-username="veeranjaneyulutoka" target="_blank" rel="noopener noreferrer">Veeranjaneyulu TOka</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4094888102" data-role="relative-time" class="time-ago" title="Friday, September 14, 2018 12:17 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi Olivier Moindrot,</p><p>Very nice post and really helpful, I am trying to run the code from your github with mnist dataset. I could notice that loss is not going down continuously, it oscillates.  Is it correct behavior?</p><p>Thanks,<br>Veeru.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1vpznvq" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4094888102"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4105610586"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4105610586"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4094888102" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Veeranjaneyulu TOka</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4105610586" data-role="relative-time" class="time-ago" title="Thursday, September 20, 2018 6:58 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi,</p><p>This is totally normal. The loss is the average over all triplets which have a positive loss.</p><p>For instance at the beginning of training, you'll have 1000 triplets with positive loss, and the average loss might be 0.7.</p><p>At the end of training, you might have only 10 triplets with positive loss (because the model has converged) but the average loss might still be at 0.8 for instance.</p><p>If you want to see if your model converge, you should follow the plot of the number of positive triplets.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-2" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">2</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1vwdhei" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4105610586"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4119976523"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4119976523"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_BqfGw61S5w/" data-action="profile" data-username="disqus_BqfGw61S5w" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="322859086" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_BqfGw61S5w/" data-action="profile" data-username="disqus_BqfGw61S5w" target="_blank" rel="noopener noreferrer"></a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4105610586" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4119976523" data-role="relative-time" class="time-ago" title="Saturday, September 29, 2018 3:42 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>for this question, I'm curious why not take the sum of the positive triplet loss as the final loss but the average value. Will it affect the convegence?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1w4xe8b" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4119976523"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4124832422"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4124832422"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4119976523" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> </a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4124832422" data-role="relative-time" class="time-ago" title="Tuesday, October 2, 2018 11:46 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>(In general it's better to take the average over the batch, and not the sum so that your loss is about the same if you change the batch size)</p><p>Your question is: "what would happen if we take the average over all triplets, and not over all triplets with positive loss".</p><p>In practice the only difference is that the scale of the loss would be lower. So if only 1% of triplets have positive loss, the loss would be divided by 100 which amount to having a lower learning rate.</p><p>I chose to take the average over positive triplets so that the loss is always in the same range, and you can manually decrease the learning rate if you want.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1w7th2e" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4124832422"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4773882563"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4773882563"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/hongtaoyang/" data-action="profile" data-username="hongtaoyang" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="343946544" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/hongtaoyang/" data-action="profile" data-username="hongtaoyang" target="_blank" rel="noopener noreferrer">Hongtao Yang</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4124832422" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4773882563" data-role="relative-time" class="time-ago" title="Tuesday, January 28, 2020 5:13 AM">7 months ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I posted a question regarding this <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fomoindrot%2Ftensorflow-triplet-loss%2Fissues%2F55%3Afgap_IWp1Bmm4HXVFxYM5PtRljU&amp;cuid=5136996" rel="nofollow noopener" title="https://github.com/omoindrot/tensorflow-triplet-loss/issues/55">here</a></p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/26y8vcz" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4773882563"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4773882563-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4124832422-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4119976523-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4111217985"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4111217985"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/veeranjaneyulutoka/" data-action="profile" data-username="veeranjaneyulutoka" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="250125618" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/veeranjaneyulutoka/" data-action="profile" data-username="veeranjaneyulutoka" target="_blank" rel="noopener noreferrer">Veeranjaneyulu TOka</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4105610586" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4111217985" data-role="relative-time" class="time-ago" title="Monday, September 24, 2018 11:53 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thank you for your quick reply. I am trying to run on my own dataset (fashion data set), and wondering what should i pass as labels?</p><p>Thanks,<br>Veeru.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1vzpo3l" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4111217985"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4112971599"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4112971599"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4111217985" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Veeranjaneyulu TOka</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4112971599" data-role="relative-time" class="time-ago" title="Tuesday, September 25, 2018 11:13 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>It depends on what you want to do, and what you have available.</p><p>For instance the labels could be the id of the dress in the picture (for instance) so that multiple views of the dress have the same id. This is similar to face recognition where the label is the identity of the person in the photo.</p><p>Or the labels could be the type of clothing...</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1w0r973" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4112971599"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4112971599-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4111217985-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4105610586-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4094888102-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4037175871"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4037175871"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/qilongzhao/" data-action="profile" data-username="qilongzhao" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="294490195" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/qilongzhao/" data-action="profile" data-username="qilongzhao" target="_blank" rel="noopener noreferrer">Qilong Zhao</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4037175871" data-role="relative-time" class="time-ago" title="Monday, August 13, 2018 8:17 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>just question how normally prediction after you get new embedding from triplet losses, any idea or just any classifier would work ?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1urmou7" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4037175871"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4049628343"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4049628343"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4037175871" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Qilong Zhao</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4049628343" data-role="relative-time" class="time-ago" title="Monday, August 20, 2018 11:10 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>You can see a similar discussion here: <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fomoindrot%2Ftensorflow-triplet-loss%2Fissues%2F5%3A33xPWUW5C8_ru1Ex55XNr1pUy9I&amp;cuid=5136996" rel="nofollow noopener" title="https://github.com/omoindrot/tensorflow-triplet-loss/issues/5">https://github.com/omoindro...</a></p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1uz1l87" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4049628343"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4049628343-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4037175871-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-3838943932"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3838943932"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/s_bastien_le_gall/" data-action="profile" data-username="s_bastien_le_gall" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="284562996" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/s_bastien_le_gall/" data-action="profile" data-username="s_bastien_le_gall" target="_blank" rel="noopener noreferrer">Sbastien LE GALL</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3838943932" data-role="relative-time" class="time-ago" title="Wednesday, April 4, 2018 6:41 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi Olivier. Very Nice blog. If Mnist had thousands of classes instead of 10. Have you thought how to modify your code to be sure that you have multiple image of same class in a each single batch. I am asking this question because I would like to implement triplet loss with database of more than 10 thousands of classes.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1rhlw3g" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3838943932"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3839118559"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3839118559"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-3838943932" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Sbastien LE GALL</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3839118559" data-role="relative-time" class="time-ago" title="Wednesday, April 4, 2018 8:26 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Fair point, it's definitely something I'll add when I have some time.<br>I guess the easiest approach would be to create a tf.data.Dataset from a generator giving batches of filenames / labels. The job of the generator would be to give a batch containing P different classes with K images each (total batch size is PK).</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1rhpmu7" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3839118559"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3839118559-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3838943932-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-3838699533"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3838699533"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/bartoszludwiczuk/" data-action="profile" data-username="bartoszludwiczuk" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="227699081" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/bartoszludwiczuk/" data-action="profile" data-username="bartoszludwiczuk" target="_blank" rel="noopener noreferrer">Bartosz Ludwiczuk</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3838699533" data-role="relative-time" class="time-ago" title="Wednesday, April 4, 2018 4:09 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Very nice post, thanks for it! From my perspective it was always easier to implement such ideas in ex. PyTorch. But look like TensorFlow code also looks nice!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1rhgnil" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3838699533"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3838749045"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3838749045"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-3838699533" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Bartosz Ludwiczuk</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3838749045" data-role="relative-time" class="time-ago" title="Wednesday, April 4, 2018 4:42 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I think PyTorch sometimes hides the details of what happens, so the computation might switch unexpectedly from the GPU to the CPU at some point (when computing the loss). I don't know much about PyTorch so it's just a guess !</p><p>Thanks for your blog posts and your work on OpenFace :)</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1rhhppx" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3838749045"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4108426748"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4108426748"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/bermanmaxim/" data-action="profile" data-username="bermanmaxim" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="139243480" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/bermanmaxim/" data-action="profile" data-username="bermanmaxim" target="_blank" rel="noopener noreferrer">Max</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-3838749045" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4108426748" data-role="relative-time" class="time-ago" title="Saturday, September 22, 2018 1:08 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>You should try it out, it really doesn't "switch devices unexpectedly" as you describe ;) nice blog post.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1vy1ud8" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4108426748"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4108426748-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3838749045-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3838699533-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-3826589716"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3826589716"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/s5plus1/" data-action="profile" data-username="s5plus1" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="283875035" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/s5plus1/" data-action="profile" data-username="s5plus1" target="_blank" rel="noopener noreferrer">s5plus1</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3826589716" data-role="relative-time" class="time-ago" title="Tuesday, March 27, 2018 4:13 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I changed triplet_strategy in params.json file to batch_hard, and found that the loss was always 0.5?</p><p>Why? batch_all is ok.</p><p>Thanks!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1ra93is" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3826589716"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3828918549"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3828918549"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-3826589716" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> s5plus1</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3828918549" data-role="relative-time" class="time-ago" title="Wednesday, March 28, 2018 10:58 PM">2 years ago</a> <span><span class="bullet time-ago-bullet" aria-hidden="true"></span> <span class="has-edit" data-role="has-edit">edited</span></span></span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Very good point ! The issue here is that as described in the post, the batch hard loss is a bit more unstable so with the default learning rate I gave (1e-3), it looks like all the embeddings collapse to a single point.<br>So if all embeddings are collapsed, the loss will always be equal to the margin (all distances are 0).</p><p>With lower learning rates (1e-4 or 3e-4), this doesn't happen and the network can learn correctly.<br>I noticed that the "batch all" strategy is more stable since learning rates of 1e-3 or 3e-3 still converge with it.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1rbn0gl" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3828918549"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3829289998"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3829289998"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/s5plus1/" data-action="profile" data-username="s5plus1" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="283875035" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/s5plus1/" data-action="profile" data-username="s5plus1" target="_blank" rel="noopener noreferrer">s5plus1</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-3828918549" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3829289998" data-role="relative-time" class="time-ago" title="Thursday, March 29, 2018 4:35 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Lower lr works.</p><p>Thanks for your reply!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1rbuz2m" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3829289998"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3829289998-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3828918549-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3826589716-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-5024569045"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="5024569045"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/omertusson/" data-action="profile" data-username="omertusson" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="104815482" src="./avatar92(5).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/omertusson/" data-action="profile" data-username="omertusson" target="_blank" rel="noopener noreferrer">omer tusson</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-5024569045" data-role="relative-time" class="time-ago" title="Monday, August 10, 2020 8:13 AM">8 days ago</a> <span><span class="bullet time-ago-bullet" aria-hidden="true"></span> <span class="has-edit" data-role="has-edit">edited</span></span></span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi,<br>Thank you for this great explanation. <br>I liked the way that you did the Matrix multiplication and broadcasting. <br>could you please guide me to resources/books to teach me this kind of advance  Matrix multiplication and broadcasting. <br>I know  Matrix multiplication and broadcasting but in basic level, I mean it never would crossed my mind to do that broadcasting like you did. Thank you.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/2b3hyad" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:5024569045"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-5024569045-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4943675213"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4943675213"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/adam_bendorf/" data-action="profile" data-username="adam_bendorf" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="350838772" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/adam_bendorf/" data-action="profile" data-username="adam_bendorf" target="_blank" rel="noopener noreferrer">Adam Bendorf</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4943675213" data-role="relative-time" class="time-ago" title="Saturday, June 6, 2020 9:29 PM">2 months ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Fantastic post.  This is the clearest explanation of online triplet mining that I've found, and it was surprisingly easy to port your tensorflow code to PyTorch.  Beautiful.  Many thanks!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/29rc47h" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4943675213"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4943675213-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4895428355"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4895428355"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/sayak_paul/" data-action="profile" data-username="sayak_paul" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="215210956" src="./avatar92(6).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/sayak_paul/" data-action="profile" data-username="sayak_paul" target="_blank" rel="noopener noreferrer">Sayak Paul</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4895428355" data-role="relative-time" class="time-ago" title="Thursday, April 30, 2020 6:42 AM">4 months ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Never thought of using diagonal to get L2 norms. This blog post is an absolute beauty. Thank you so much man :)</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/28ym0oz" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4895428355"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4895428355-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4660716542"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4660716542"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/anirudhthatipelli/" data-action="profile" data-username="anirudhthatipelli" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="275466317" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/anirudhthatipelli/" data-action="profile" data-username="anirudhthatipelli" target="_blank" rel="noopener noreferrer">Anirudh thatipelli</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4660716542" data-role="relative-time" class="time-ago" title="Monday, October 21, 2019 10:10 PM">10 months ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thanks for this informative post,</p><p>I had a doubt regarding a problem that I have. I am working on a classification problem with 120 classes and so, I would need very high batch-sizes, 1000 maybe to get good triplets. I am not having powerful GPUs and my RAM is not large too. In this scenario, should I get the triplets from all over the dataset rather than restricting myself to only the batch? Will it give me competitive results?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/252vbwe" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4660716542"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4660716542-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4606593310"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4606593310"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_tMmtS86MM5/" data-action="profile" data-username="disqus_tMmtS86MM5" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="337446175" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_tMmtS86MM5/" data-action="profile" data-username="disqus_tMmtS86MM5" target="_blank" rel="noopener noreferrer">Seb P</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4606593310" data-role="relative-time" class="time-ago" title="Friday, September 6, 2019 4:58 PM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container" style="height: auto; max-height: none;"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Great post Oliver!</p><p>I am having trouble understanding one thing, related to the method _get_anchor_positive_triplet_mask.<br>Suppose you have 4 points (&lt;point&gt;, &lt;label&gt;, &lt;coords&gt;) in a 2-D space:<br>(A, 1, [4, 3])<br>(B, 2, [2, 7])<br>(C, 3, [11, 10])<br>(D, 1, [9, 6])</p><p>The valid triplets (&lt;anchor&gt;, &lt;positive&gt;, &lt;negative&gt;) would be:<br>(A, D, B)<br>(A, D, C)<br>(D, A, B)<br>(D, A, C)</p><p>The hardest triplets are:<br>(A, D, B) (B is closer to A, compared to C)<br>(D, A, C) (C is closer to D, compared to B)</p><p>Following the batch_hard (L_BH) from the paper that you referenced (Hermans et al.),<br>the L_BH of this batch would be:<br>(margin + d(A, D) - d(A, B)) +<br>(margin + d(D, A) - d(D, C))</p><p>Right?</p><p>But when I compute the L_BH presented above, I get a different value from your implementation batch_hard_triplet_loss.<br>Is my assumption of the L_BH wrong?</p><p>Thank you in advance.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more" data-tid="1350">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/246na5a" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4606593310"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4609595701"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4609595701"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_tMmtS86MM5/" data-action="profile" data-username="disqus_tMmtS86MM5" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="337446175" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_tMmtS86MM5/" data-action="profile" data-username="disqus_tMmtS86MM5" target="_blank" rel="noopener noreferrer">Seb P</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4606593310" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Seb P</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4609595701" data-role="relative-time" class="time-ago" title="Monday, September 9, 2019 2:15 PM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I know why this happened. When you calculate the hardest minimum, you do tf.reduce_max, when you should be looking for the argmin (the closest negative). Hope I'm right :)</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/248fmt1" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4609595701"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4616851052"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4616851052"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4609595701" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Seb P</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4616851052" data-role="relative-time" class="time-ago" title="Sunday, September 15, 2019 8:11 PM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Could you give more information on the exact location of the bug you found?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/24cr52k" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4616851052"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4617499454"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4617499454"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_tMmtS86MM5/" data-action="profile" data-username="disqus_tMmtS86MM5" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="337446175" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_tMmtS86MM5/" data-action="profile" data-username="disqus_tMmtS86MM5" target="_blank" rel="noopener noreferrer">Seb P</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4616851052" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4617499454" data-role="relative-time" class="time-ago" title="Monday, September 16, 2019 11:58 AM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi <a data-dsq-mention="oliviermoindrot:disqus" href="https://disqus.com/by/oliviermoindrot/" rel="nofollow noopener" title="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" class="mention">Olivier Moindrot</a>    .<br>I'm so sorry, there is no bug. I misinterpreted the code... But the batch_hard_triplet_loss that you implemented is yielding a different value from the expression on the paper In Defense of the Triplet Loss for Person Re-Identification, following my calculations, regarding the example that I wrote on my first comment.<br>In my example, the two hardest triplets (&lt;anchor&gt;, &lt;positive&gt;, &lt;negative&gt;) are: (A, D, B) and (D, A, C). If the margin is 1, shouldn't the hard triplet loss be:<br>(1 + d(A, D) - d(A, B)) + (1 + d(D, A) - d(D, C))? <br>Thank you, and sorry again for my misinterpretation...</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/24d51dq" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4617499454"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4617499454-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4616851052-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4609595701-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4606593310-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4550312552"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4550312552"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_5PwfaXWpZy/" data-action="profile" data-username="disqus_5PwfaXWpZy" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="335339188" src="./avatar92(7).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_5PwfaXWpZy/" data-action="profile" data-username="disqus_5PwfaXWpZy" target="_blank" rel="noopener noreferrer">Karan Sharma</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4550312552" data-role="relative-time" class="time-ago" title="Tuesday, July 23, 2019 3:24 PM">a year ago</a> <span><span class="bullet time-ago-bullet" aria-hidden="true"></span> <span class="has-edit" data-role="has-edit">edited</span></span></span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi <a data-dsq-mention="oliviermoindrot:disqus" href="https://disqus.com/by/oliviermoindrot/" rel="nofollow noopener" title="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" class="mention">Olivier Moindrot</a>  I find your post quite helpful in understanding the implementation of triplet loss function. I want to ask you that I wish to train a face recognition model on a data-set which doesn't contain human images, so what model do you suggest me to use here?</p><p>Also, any suggestion for triplet loss hyperparameter based on the size of dataset?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/2394zmw" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4550312552"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4563291879"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4563291879"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4550312552" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Karan Sharma</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4563291879" data-role="relative-time" class="time-ago" title="Friday, August 2, 2019 5:53 PM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I'm not sure what you mean by face recognition without human images (maybe it's on animals?), but the idea stays the same: the triplet loss will bring together examples from the same identity and separate examples from different identities.</p><p>For the parameters, I would start with a low learning rate and closely watch metrics to see how the embeddings are improving. The margin doesn't seem to have a very big impact.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/23gv6jr" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4563291879"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4565763635"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4565763635"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_5PwfaXWpZy/" data-action="profile" data-username="disqus_5PwfaXWpZy" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="335339188" src="./avatar92(7).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_5PwfaXWpZy/" data-action="profile" data-username="disqus_5PwfaXWpZy" target="_blank" rel="noopener noreferrer">Karan Sharma</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4563291879" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4565763635" data-role="relative-time" class="time-ago" title="Sunday, August 4, 2019 9:38 PM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thanks a lot for the response.<br>I am planning to work currently on cat images. Do you have any suggestions for size of data-set I should have? Say If I have 50 different images for 100 different cats, is this a good enough number to start with. Your comment on this will be a lot of help.</p><p>Again, I find that many people have used facenet architecture to train face recognition models. Should I stick to facenet architecture or you have some suggestions here for me. Your opinions are much appreciated.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/23ic5rn" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4565763635"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4565763635-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4563291879-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4550312552-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4541510490"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4541510490"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/khairulimam/" data-action="profile" data-username="khairulimam" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="113397992" src="./avatar92(8).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/khairulimam/" data-action="profile" data-username="khairulimam" target="_blank" rel="noopener noreferrer">Khairul Imam</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4541510490" data-role="relative-time" class="time-ago" title="Tuesday, July 16, 2019 12:36 PM">a year ago</a> <span><span class="bullet time-ago-bullet" aria-hidden="true"></span> <span class="has-edit" data-role="has-edit">edited</span></span></span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi! One question again <br>I don't understand your <code>_pairwise_distanse</code> method. How do you compute the distance between point a to b since there's no input for b? The only input you provide to that method is the embedding which in my understanding that embedding is stands for one point only for each row, since you stated that the shape of the embedding is (B, embed_size).</p><p>Thanks</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/233wbx6" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4541510490"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4541634589"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4541634589"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/khairulimam/" data-action="profile" data-username="khairulimam" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="113397992" src="./avatar92(8).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/khairulimam/" data-action="profile" data-username="khairulimam" target="_blank" rel="noopener noreferrer">Khairul Imam</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4541510490" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Khairul Imam</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4541634589" data-role="relative-time" class="time-ago" title="Tuesday, July 16, 2019 3:03 PM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I just realized that matrix multiplication is gonna operate on each embedding hence it will produce the difference on every embedding combinations. Respect to my question point b is the embedding transpose </p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/233yzod" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4541634589"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4541634589-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4541510490-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4529019196"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4529019196"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/khairulimam/" data-action="profile" data-username="khairulimam" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="113397992" src="./avatar92(8).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/khairulimam/" data-action="profile" data-username="khairulimam" target="_blank" rel="noopener noreferrer">Khairul Imam</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4529019196" data-role="relative-time" class="time-ago" title="Saturday, July 6, 2019 6:37 AM">a year ago</a> <span><span class="bullet time-ago-bullet" aria-hidden="true"></span> <span class="has-edit" data-role="has-edit">edited</span></span></span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hey Olivier, really nice write up! However I have some question:<br>How is semi-hard triplets can be satisfied while<i> d(a,n) </i> greater than <i>d(a,p)</i> while it's less than <i>d(a,p) </i> plus some margin?<br> <span><a href="https://uploads.disquscdn.com/images/7a998e4fc53e0865b52ab363eeca5b9694d0fb726aad5deaa20f2b6ca6bd6084.png" class="post-media-link" data-action="expand-collapse-media" rel="nofollow"><i class="icon-images"></i>View<span class="post-media-link-domain">  uploads.disquscdn.com</span></a>
</span><div class="media-container">
<a class="media-button media-button-expand publisher-color publisher-border-color" href="https://uploads.disquscdn.com/images/7a998e4fc53e0865b52ab363eeca5b9694d0fb726aad5deaa20f2b6ca6bd6084.png" rel="nofollow" target="_blank" data-action="expand" title="">
<i class="icon-images publisher-background-color"></i>
View
</a>
<a class="media-button media-button-contract publisher-color publisher-border-color" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" target="_blank" data-action="contract">
<i class="icon-cancel publisher-background-color"></i> Hide
</a>
<div class="media-content-loader" data-role="content-loader"></div>
<div data-role="content-placeholder" class="media-content-placeholder media-Disquscdn "><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="media-force-load" data-action="force-load"><i class="icon-images"></i></a>
</div>
</div></p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/22wglks" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4529019196"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4530291671"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4530291671"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4529019196" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Khairul Imam</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4530291671" data-role="relative-time" class="time-ago" title="Sunday, July 7, 2019 2:40 PM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Not sure about your question but for instance:</p><p>d(a, p) = 2.4<br>d(a, n) = 2.6<br>margin = 1</p><p>In this case, the triplet would be semi-hard.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/22x7vfb" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4530291671"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4531043947"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4531043947"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/khairulimam/" data-action="profile" data-username="khairulimam" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="113397992" src="./avatar92(8).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/khairulimam/" data-action="profile" data-username="khairulimam" target="_blank" rel="noopener noreferrer">Khairul Imam</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4530291671" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4531043947" data-role="relative-time" class="time-ago" title="Monday, July 8, 2019 4:13 AM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Oh yes! That's clear, thanks. My mind was confused I can't think clearly when I was reading your blog. Thank you.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/22xnzvv" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4531043947"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4531043947-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4530291671-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4529019196-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4523026734"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4523026734"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/jaedukseo/" data-action="profile" data-username="jaedukseo" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="274955323" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/jaedukseo/" data-action="profile" data-username="jaedukseo" target="_blank" rel="noopener noreferrer">Jae Duk Seo</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4523026734" data-role="relative-time" class="time-ago" title="Monday, July 1, 2019 6:01 PM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>very good post thank you</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/22sw5ri" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4523026734"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4523026734-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4411215278"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4411215278"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_27jfaFFNct/" data-action="profile" data-username="disqus_27jfaFFNct" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="24246478" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_27jfaFFNct/" data-action="profile" data-username="disqus_27jfaFFNct" target="_blank" rel="noopener noreferrer">William Smith</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4411215278" data-role="relative-time" class="time-ago" title="Friday, April 5, 2019 10:06 PM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi, thanks for the great post, it was really helpful for me! I am using a similar approach on triplet learning and am using PCA on the embeddings before calculating the loss. Training starts well but quickly collapses. Apart from reducing the learning rate are there any other things I can do to help prevent this collapse?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/20ybnhq" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4411215278"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4425164172"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4425164172"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4411215278" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> William Smith</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4425164172" data-role="relative-time" class="time-ago" title="Tuesday, April 16, 2019 4:25 PM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I'm not sure how PCA influences this collapse.</p><p>Maybe you could try to directly reduce the size of the embedding, or just add a linear layer to reduce the dimension instead of doing the PCA.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/216mmj0" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4425164172"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4497022720"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4497022720"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_27jfaFFNct/" data-action="profile" data-username="disqus_27jfaFFNct" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="24246478" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_27jfaFFNct/" data-action="profile" data-username="disqus_27jfaFFNct" target="_blank" rel="noopener noreferrer">William Smith</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4425164172" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4497022720" data-role="relative-time" class="time-ago" title="Monday, June 10, 2019 9:23 PM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thanks for the suggestions!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/22desxs" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4497022720"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4497022720-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4425164172-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4411215278-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4391183524"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4391183524"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_8v39w8aaJH/" data-action="profile" data-username="disqus_8v39w8aaJH" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="330406921" src="./avatar92(9).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_8v39w8aaJH/" data-action="profile" data-username="disqus_8v39w8aaJH" target="_blank" rel="noopener noreferrer"> </a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4391183524" data-role="relative-time" class="time-ago" title="Saturday, March 23, 2019 1:58 PM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>hello Olivier and thanks for this awesome implementation, i have one question though, shouldn't the hardest_positive_dist decrease as the algorithm keeps learning? i am using it on mnist for testing. <span><a href="https://uploads.disquscdn.com/images/159b2b5c865d52f0e92b8b146e2b712c4481a12dbb57495442a7e96af5e35260.png" class="post-media-link" data-action="expand-collapse-media" rel="nofollow"><i class="icon-images"></i>View<span class="post-media-link-domain">  uploads.disquscdn.com</span></a>
</span><div class="media-container">
<a class="media-button media-button-expand publisher-color publisher-border-color" href="https://uploads.disquscdn.com/images/159b2b5c865d52f0e92b8b146e2b712c4481a12dbb57495442a7e96af5e35260.png" rel="nofollow" target="_blank" data-action="expand" title="">
<i class="icon-images publisher-background-color"></i>
View
</a>
<a class="media-button media-button-contract publisher-color publisher-border-color" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" target="_blank" data-action="contract">
<i class="icon-cancel publisher-background-color"></i> Hide
</a>
<div class="media-content-loader" data-role="content-loader"></div>
<div data-role="content-placeholder" class="media-content-placeholder media-Disquscdn "><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="media-force-load" data-action="force-load"><i class="icon-images"></i></a>
</div>
</div></p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/20meaw4" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4391183524"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4399882014"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4399882014"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4391183524" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i>  </a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4399882014" data-role="relative-time" class="time-ago" title="Thursday, March 28, 2019 5:21 PM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I assume these curves are on the training set.</p><p>As long as the difference between hardest negative and hardest positive increases, this seems ok to me.</p><p>It could be that all examples are slowly moving apart, so the average distance gets bigger. But the negative distance is still twice the positive distance.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/20rkqou" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4399882014"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4400224474"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4400224474"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_8v39w8aaJH/" data-action="profile" data-username="disqus_8v39w8aaJH" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="330406921" src="./avatar92(9).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_8v39w8aaJH/" data-action="profile" data-username="disqus_8v39w8aaJH" target="_blank" rel="noopener noreferrer"> </a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4399882014" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4400224474" data-role="relative-time" class="time-ago" title="Thursday, March 28, 2019 9:17 PM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>i measured some other metrics and i came to the conclusion that it has to do with the network architecture. As you can see train and validation accuracy goes up about 0.99 and then it steadily goes down.I want to build a siamese with many classes and i cant get a decent number of true positives in each batch, so hard triplet mining is useless, do you know any way of creating a batch with specific number of true positives in it?<br><span><a href="https://uploads.disquscdn.com/images/42acaeb2eb471eb15cd7632d44958e513a176d6037a348808405cffb74435444.png" class="post-media-link" data-action="expand-collapse-media" rel="nofollow"><i class="icon-images"></i>View<span class="post-media-link-domain">  uploads.disquscdn.com</span></a>
</span><div class="media-container">
<a class="media-button media-button-expand publisher-color publisher-border-color" href="https://uploads.disquscdn.com/images/42acaeb2eb471eb15cd7632d44958e513a176d6037a348808405cffb74435444.png" rel="nofollow" target="_blank" data-action="expand" title="">
<i class="icon-images publisher-background-color"></i>
View
</a>
<a class="media-button media-button-contract publisher-color publisher-border-color" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" target="_blank" data-action="contract">
<i class="icon-cancel publisher-background-color"></i> Hide
</a>
<div class="media-content-loader" data-role="content-loader"></div>
<div data-role="content-placeholder" class="media-content-placeholder media-Disquscdn "><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="media-force-load" data-action="force-load"><i class="icon-images"></i></a>
</div>
</div> <br>thank you for your time :)</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/20rs2xm" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4400224474"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4401272093"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4401272093"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_8v39w8aaJH/" data-action="profile" data-username="disqus_8v39w8aaJH" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="330406921" src="./avatar92(9).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_8v39w8aaJH/" data-action="profile" data-username="disqus_8v39w8aaJH" target="_blank" rel="noopener noreferrer"> </a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4400224474" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i>  </a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4401272093" data-role="relative-time" class="time-ago" title="Friday, March 29, 2019 4:55 PM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>i was trying with high level tensorflow and i rewrote my code in lower level and i figured it out, thanks for the the useful information on this blog anyways :D</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/20seja5" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4401272093"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4401272093-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4400224474-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4399882014-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4391183524-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4352934234"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4352934234"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/suihongsong/" data-action="profile" data-username="suihongsong" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="329279755" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/suihongsong/" data-action="profile" data-username="suihongsong" target="_blank" rel="noopener noreferrer">Suihong Song</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4352934234" data-role="relative-time" class="time-ago" title="Monday, February 25, 2019 6:06 AM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi, Olivier,<br>Thanks so much for your wonderful post and code. I am using part of your code and ideas in my research on encoding binary geological images, such as different types of rivers.<br>The problem I am facing is: the positive and negative distances are always inclined to be 0, so the loss always converge at margin I set.. I tried with lower learning rate (as low as le-7) and tried with Batch_all, but they all failed. It seems the embeddings are all get together in a very small space as you said in some supply.<br>Can you give me some comments or suggestions? I have been in this problem for days.<br>Thanks so much.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1zzmhju" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4352934234"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4357268630"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4357268630"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4352934234" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Suihong Song</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4357268630" data-role="relative-time" class="time-ago" title="Wednesday, February 27, 2019 11:40 PM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>It's difficult to say... Are all the embeddings collapsing to the same point? What kind of data are you dealing with exactly? And what consistantes a positive vs. negative pair (same geological structure?)</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/2027dzq" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4357268630"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4357268630-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4352934234-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4349020485"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4349020485"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_JpGIXnEPIo/" data-action="profile" data-username="disqus_JpGIXnEPIo" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="329167665" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_JpGIXnEPIo/" data-action="profile" data-username="disqus_JpGIXnEPIo" target="_blank" rel="noopener noreferrer">ASP</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4349020485" data-role="relative-time" class="time-ago" title="Friday, February 22, 2019 8:14 AM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi Olivier!<br>Very informative post. Thanks! In it's current state of implementation, can the model be trained on RGB images of any size without any modifications?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1zxalol" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4349020485"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4349102498"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4349102498"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4349020485" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> ASP</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4349102498" data-role="relative-time" class="time-ago" title="Friday, February 22, 2019 10:27 AM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>You would have to modify the <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fomoindrot%2Ftensorflow-triplet-loss%2Fblob%2Ffc698369bb6c9acdc9f0e9e1ea00de0ddf782f12%2Fmodel%2Fmodel_fn.py%23L9%3AYhAytD42TZwtzTW3kePdD-_BH44&amp;cuid=5136996" rel="nofollow noopener" title="https://github.com/omoindrot/tensorflow-triplet-loss/blob/fc698369bb6c9acdc9f0e9e1ea00de0ddf782f12/model/model_fn.py#L9">build_model</a> function to add your CNN model that takes RGB inputs.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1zxccyq" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4349102498"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4349102498-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4349020485-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4337101565"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4337101565"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/matthiaswamhoff/" data-action="profile" data-username="matthiaswamhoff" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="328852132" src="./avatar92(10).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/matthiaswamhoff/" data-action="profile" data-username="matthiaswamhoff" target="_blank" rel="noopener noreferrer">Matthias Wamhoff</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4337101565" data-role="relative-time" class="time-ago" title="Thursday, February 14, 2019 12:41 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hey Olivier,<br>your implementation helped me a lot, thank you. I noticed that, unlike in the facenet paper, you didn't apply L2-normalization to the CNN output. Could you explain why? <br>Best<br>Matthias</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1zq74zh" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4337101565"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4349101722"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4349101722"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4337101565" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Matthias Wamhoff</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4349101722" data-role="relative-time" class="time-ago" title="Friday, February 22, 2019 10:26 AM">a year ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Check this issue where I answered this: <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fomoindrot%2Ftensorflow-triplet-loss%2Fissues%2F10%3A3Q5zszTvJzq88x5ad6Jm3wlJZak&amp;cuid=5136996" rel="nofollow noopener" title="https://github.com/omoindrot/tensorflow-triplet-loss/issues/10">https://github.com/omoindro...</a></p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1zxccd6" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4349101722"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4349101722-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4337101565-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4323699616"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4323699616"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/sergeyshuvaev/" data-action="profile" data-username="sergeyshuvaev" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="328483615" src="./avatar92(11).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/sergeyshuvaev/" data-action="profile" data-username="sergeyshuvaev" target="_blank" rel="noopener noreferrer">sergeyshuvaev</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4323699616" data-role="relative-time" class="time-ago" title="Tuesday, February 5, 2019 7:56 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thanks for the thorough explanation of triplet loss, it was very useful.<br>I try to use triplet loss on a custom dataset (100k images, 15k classes) with a convolutional neural net (input: 204x204x1; neural net: VGG (50%of a usual number of filters in each layer); learning rate: 10^-3, momentum: 10^-4; optimizer: Adam; minibatch: 400 images; loss: batch-all (does not converge with batch-hardest); margin: 0.1; embedding: 16D hypersphere), and it overfits badly (99% zero-loss valid triplets for training set; 63% for validation set).</p><p>Therefore the question is:<br>-Is there anything obvious I'm doing wrong?<br>-What are the general guidelines for choosing dimensionality of embbeding, and the margin?</p><p>Thanks in advance.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1zi7vz4" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4323699616"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4325236269"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4325236269"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4323699616" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> sergeyshuvaev</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4325236269" data-role="relative-time" class="time-ago" title="Wednesday, February 6, 2019 6:48 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Just to check, are you creating balanced batches to have enough valid triplets? (by opposition to taking random batches).<br>If not, the issue is over your batch size (400) you will have few pairs of the same class (since you have 7 images per class on average).<br>The solution would be to have batches of size 400 but with for instance 100 different classes, and 4 images each.</p><p>If the problem really is overfitting, maybe you could add dropout / regularization?</p><p>Also how do you split between train / test? Do you have totally different classes in the test set? If so, the task will be more difficult since you've never seen those classes.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1zj4tnx" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4325236269"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4786006753"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4786006753"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/francescolupo/" data-action="profile" data-username="francescolupo" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="83211202" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/francescolupo/" data-action="profile" data-username="francescolupo" target="_blank" rel="noopener noreferrer">francesco lupo</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4325236269" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4786006753" data-role="relative-time" class="time-ago" title="Thursday, February 6, 2020 5:03 PM">6 months ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I understand that I need to make sure that there are more than one image per each class in one batch, but does the batch need to be balanced?<br>Is it okay if I have 5 images for one class and 4 images for another class etc?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/275gqg1" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4786006753"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4786006753-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4326805841"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4326805841"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/sergeyshuvaev/" data-action="profile" data-username="sergeyshuvaev" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="328483615" src="./avatar92(11).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/sergeyshuvaev/" data-action="profile" data-username="sergeyshuvaev" target="_blank" rel="noopener noreferrer">sergeyshuvaev</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4325236269" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4326805841" data-role="relative-time" class="time-ago" title="Thursday, February 7, 2019 6:38 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thanks for a quick response.<br>The problem turned out to be in the TensorFlow's Dataset API: for some reason, shuffling function doesn't shuffle at all. Therefore same triplets would reside in same minibatches, and triplet loss would be only enforced locally. Trying to overcome this bug atm :)</p><p>Over than that, I make sure that my minibatches contain multiple samples of each class, and I do regularize. My test set consists of the classes not present in training.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1zk2gr5" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4326805841"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4326805841-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4325236269-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4323699616-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4301367133"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4301367133"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/amlfawzy/" data-action="profile" data-username="amlfawzy" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="327867891" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/amlfawzy/" data-action="profile" data-username="amlfawzy" target="_blank" rel="noopener noreferrer">Aml Fawzy</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4301367133" data-role="relative-time" class="time-ago" title="Tuesday, January 22, 2019 1:08 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>i am interested in this post i want to train a network like above but for hand can any one help me ?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1z4x84d" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4301367133"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4301367133-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4192595162"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4192595162"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/fsetra/" data-action="profile" data-username="fsetra" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="162447634" src="./avatar92(12).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/fsetra/" data-action="profile" data-username="fsetra" target="_blank" rel="noopener noreferrer">Francesco Setragno</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4192595162" data-role="relative-time" class="time-ago" title="Tuesday, November 13, 2018 12:06 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi, I am training with my own dataset. Do you have any suggestion about the relationship between number of images, number of classes and batch size?<br>Another question: what can I infer from the plots "hardest negative distance" and "hardest positive distance" during training with batch hard strategy? Is it correct that the first should increase and the second should decrease?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1xc5v4q" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4192595162"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4195940490"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4195940490"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4192595162" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Francesco Setragno</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4195940490" data-role="relative-time" class="time-ago" title="Thursday, November 15, 2018 10:16 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>For your first point I assume you are talking about how many class / images to put in a batch.</p><p>The batch should be as big as possible (i.e. as big as your GPU can fit, so maybe 128 or 256).<br>If you have a high number of classes, I would suggest getting a diverse batch by using only 4 or 8 examples per class (less would not work well).</p><p>For your other question yes, the first should increase and the second decrease. However I'm not sure if this is the best way to monitor training, since you can always have outliers (misclassified examples for instance) which will be hard negatives.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1xe5kei" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4195940490"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4195981915"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4195981915"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/fsetra/" data-action="profile" data-username="fsetra" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="162447634" src="./avatar92(12).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/fsetra/" data-action="profile" data-username="fsetra" target="_blank" rel="noopener noreferrer">Francesco Setragno</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4195940490" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4195981915" data-role="relative-time" class="time-ago" title="Thursday, November 15, 2018 10:51 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>For the first point, I was referring to the dataset: is it better to have a small number of classes with many images per class, or a high number of classes with few images per class? Or something in between?<br>For the second point, isn't the triplet loss computed as a difference between those two values? Wouldn't outliers directly influence the loss?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1xe6gd7" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4195981915"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4196129398"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4196129398"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4195981915" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Francesco Setragno</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4196129398" data-role="relative-time" class="time-ago" title="Thursday, November 15, 2018 12:04 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>It's a good question, I would split with the most meaningful classes. It will be easier to train if you have fewer classes and more images per class, maybe 100 images per class should be enough? Or 1000?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1xe9m5y" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4196129398"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4196129398-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4195981915-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4195940490-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4192595162-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4134673875"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4134673875"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/serge_mosin/" data-action="profile" data-username="serge_mosin" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="250228883" src="./avatar92(13).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/serge_mosin/" data-action="profile" data-username="serge_mosin" target="_blank" rel="noopener noreferrer">Serge Mosin</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4134673875" data-role="relative-time" class="time-ago" title="Monday, October 8, 2018 1:34 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thanks, <a data-dsq-mention="oliviermoindrot:disqus" href="https://disqus.com/by/oliviermoindrot/" rel="nofollow noopener" title="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" class="mention">Olivier Moindrot</a> . Am I right that you're using some hand-made CNN for the testing: <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fomoindrot%2Ftensorflow-triplet-loss%2Fblob%2Fmaster%2Fmodel%2Fmodel_fn.py%23L9%3F%3AJY9fmtQqP1iDnCMZwJLKRL69VAA&amp;cuid=5136996" rel="nofollow noopener" title="https://github.com/omoindrot/tensorflow-triplet-loss/blob/master/model/model_fn.py#L9?">https://github.com/omoindro...</a> <br>Let's say I want to use some pre-trained network, such as Resnet. Should I simply adjust this line then: <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fomoindrot%2Ftensorflow-triplet-loss%2Fblob%2Fmaster%2Fmodel%2Fmodel_fn.py%23L66%3F%3AJkpTS_pQ6gH1kT1ag363ildSA5I&amp;cuid=5136996" rel="nofollow noopener" title="https://github.com/omoindrot/tensorflow-triplet-loss/blob/master/model/model_fn.py#L66?">https://github.com/omoindro...</a></p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1wdoes3" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4134673875"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4134690720"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4134690720"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4134673875" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Serge Mosin</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4134690720" data-role="relative-time" class="time-ago" title="Monday, October 8, 2018 1:50 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Yes you can replace the "build_model" function by anything that returns an embedding of shape (N, D) where N is the batch size.</p><p>Be carful not to add a ReLU at the end of your model (the last layer should be a fully connected layer with no activation).</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1wdors0" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4134690720"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4137804968"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4137804968"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/serge_mosin/" data-action="profile" data-username="serge_mosin" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="250228883" src="./avatar92(13).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/serge_mosin/" data-action="profile" data-username="serge_mosin" target="_blank" rel="noopener noreferrer">Serge Mosin</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4134690720" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4137804968" data-role="relative-time" class="time-ago" title="Wednesday, October 10, 2018 8:16 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hey <a data-dsq-mention="oliviermoindrot:disqus" href="https://disqus.com/by/oliviermoindrot/" rel="nofollow noopener" title="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" class="mention">Olivier Moindrot</a> . Been trying to do that during these days and failed miserably :) I can't seem to understand how to properly integrate pretrained DNN (ResNet for example: <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ftensorflow%2Fmodels%2Ftree%2Fmaster%2Fofficial%2Fresnet%29%3ACSiiLsjzzCBrkOfw930vjRHNF8Y&amp;cuid=5136996" rel="nofollow noopener" title="https://github.com/tensorflow/models/tree/master/official/resnet)">https://github.com/tensorfl...</a> into model_fn call to retrain with triplet loss. Do you have any ideas? And is this Estimator approach suitable for this kind of task at all? It looks like model_fn function is pretty low level.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1wfjiqw" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4137804968"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4137927071"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4137927071"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4137804968" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Serge Mosin</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4137927071" data-role="relative-time" class="time-ago" title="Wednesday, October 10, 2018 10:56 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Maybe you can use TensorFlow Hub to get a pretrained resnet inside the "model_fn".</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1wfm4yn" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4137927071"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4137927071-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4137804968-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4134690720-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4134673875-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4110188715"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4110188715"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_xzwWHlIjal/" data-action="profile" data-username="disqus_xzwWHlIjal" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="319156859" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_xzwWHlIjal/" data-action="profile" data-username="disqus_xzwWHlIjal" target="_blank" rel="noopener noreferrer">Albert</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4110188715" data-role="relative-time" class="time-ago" title="Sunday, September 23, 2018 7:02 PM">2 years ago</a> <span><span class="bullet time-ago-bullet" aria-hidden="true"></span> <span class="has-edit" data-role="has-edit">edited</span></span></span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hi Oliver, thank you very much for such an interesting and helpful post. It has solved a lot of doubts I had. I'm new to CNN learning and I still have a question: <br>As can be read here <a href="https://disq.us/url?url=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F33330779%2Fwhats-the-triplet-loss-back-propagation-gradient-formula%3ADruNlbSAIp85Z8FQSMrLfUnf6Gg&amp;cuid=5136996" rel="nofollow noopener" title="https://stackoverflow.com/questions/33330779/whats-the-triplet-loss-back-propagation-gradient-formula">https://stackoverflow.com/q...</a>, a different gradient is backpropagated for the anchor, positive and negative of every triplet that contributes to the batch average loss. So, some unique training images may contribute many times to the final average loss (for example, image 1 with triplets 1-2-11 and 1-3-12), and have different gradients computed during backpropagation. How does backpropagation take this into account? The many gradients computed for a single image (image 1 in the example) are averaged? Only the gradients with respect to the output embedding are averaged, or added, and then a single backward pass is required for each unique training image? It's a very basic question but I haven't found yet the answer. Thank you!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1vz3lwr" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4110188715"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4111133533"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4111133533"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4110188715" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Albert</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4111133533" data-role="relative-time" class="time-ago" title="Monday, September 24, 2018 10:00 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>It's true that you have a different gradient for each part of the loss. However, since the final loss is the average of these losses, the final gradient will just be the average of the corresponding gradients.</p><p>On a simpler example, suppose your loss is $L = L_1 + L_2$ with $L_1 = x^2$ and $L_2 = 2x$.</p><p>Then the gradients for x will be $G_1 = 2x$ and $G_2 = 2$.</p><p>As the final loss is the sum of the two losses, the final gradient will be the sum of the gradients: $G = 2x + 2$.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1vznuxp" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4111133533"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4111133533-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4110188715-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4105602970"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4105602970"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/jeffreycordero/" data-action="profile" data-username="jeffreycordero" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="71886285" src="./avatar92(14).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/jeffreycordero/" data-action="profile" data-username="jeffreycordero" target="_blank" rel="noopener noreferrer">Jeffrey Cordero</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4105602970" data-role="relative-time" class="time-ago" title="Thursday, September 20, 2018 6:53 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Hello Olivier,<br>Thank you, thank you so much for such a detailed post!  I've been struggling to understand hard sample mining with triplet loss, and finally try understand it!<br>Your my favorite person right now,<br>Jeffrey</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1vwdbiy" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4105602970"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4105606621"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4105606621"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4105602970" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Jeffrey Cordero</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4105606621" data-role="relative-time" class="time-ago" title="Thursday, September 20, 2018 6:56 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thank you for the kind words :)<br>Good luck in your projects !</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1vwdecd" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4105606621"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4105606621-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4105602970-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4091719715"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4091719715"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_g0CpQJQV5M/" data-action="profile" data-username="disqus_g0CpQJQV5M" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="297564361" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_g0CpQJQV5M/" data-action="profile" data-username="disqus_g0CpQJQV5M" target="_blank" rel="noopener noreferrer">Yi Liu</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4091719715" data-role="relative-time" class="time-ago" title="Wednesday, September 12, 2018 6:44 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Nice post! In this post, you use hard and semi-hard negative to train the network. The people in TF implement the loss only with semi-hard negative. I'm confused with their performance. Which one is better and which one do you recommend?<br>I know if we use hard negative, the training will become harder. And my guess is using semi-hard make a tradeoff between the training stability and the efficiency? Am I correct?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1vo3r4z" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4091719715"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4091729341"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4091729341"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4091719715" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Yi Liu</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4091729341" data-role="relative-time" class="time-ago" title="Wednesday, September 12, 2018 6:49 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>It really depends on the quality of your data (low quality means hard negatives will be outliers).<br>Semi-hard negative is a good choice in general, but in this post I also talked about the "batch_all" loss where you actually average over all the possible triplets in the batch, which might also work well.</p><p>I would recommend trying them all since it's difficult to say in advance which ones will work best.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1vo3ykd" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4091729341"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4092273023"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4092273023"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_g0CpQJQV5M/" data-action="profile" data-username="disqus_g0CpQJQV5M" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="297564361" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_g0CpQJQV5M/" data-action="profile" data-username="disqus_g0CpQJQV5M" target="_blank" rel="noopener noreferrer">Yi Liu</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4091729341" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4092273023" data-role="relative-time" class="time-ago" title="Thursday, September 13, 2018 12:20 AM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Another discussion. As I understanding, the margin is used to control the dissimilarity between the positive and the negative. But the absolute value of M seems not so important, because if we use a larger margin, the network can just magnify the norm of the embedding to minimize the loss. So I think the margin in the expression is only an "indicator", and we can use an arbitrary (need to be reasonable) value as M and no need to tune it.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1vofm2n" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4092273023"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4093248867"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4093248867"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4092273023" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Yi Liu</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4093248867" data-role="relative-time" class="time-ago" title="Thursday, September 13, 2018 3:57 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Once again you're right that in theory the exact value of the margin doesn't matter, since the network can adapt by scaling up or down the last layer.</p><p>However in practice, when optimizing with triplet loss the value of the margin has an impact on training. Typical values are [0.1, 0.2, 0.5, 1.0].<br>So once again, you'll have to try different values and see how much it varies !</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="" name="Vote up"><span class="updatable count" data-role="likes">1</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1vp0j1f" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4093248867"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4093260203"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4093260203"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_g0CpQJQV5M/" data-action="profile" data-username="disqus_g0CpQJQV5M" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="297564361" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_g0CpQJQV5M/" data-action="profile" data-username="disqus_g0CpQJQV5M" target="_blank" rel="noopener noreferrer">Yi Liu</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4093248867" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4093260203" data-role="relative-time" class="time-ago" title="Thursday, September 13, 2018 4:03 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I see. Thank you for your kind reply!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1vp0rsb" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4093260203"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4093260203-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4093248867-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4092273023-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4091737554"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4091737554"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_g0CpQJQV5M/" data-action="profile" data-username="disqus_g0CpQJQV5M" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="297564361" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_g0CpQJQV5M/" data-action="profile" data-username="disqus_g0CpQJQV5M" target="_blank" rel="noopener noreferrer">Yi Liu</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4091729341" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4091737554" data-role="relative-time" class="time-ago" title="Wednesday, September 12, 2018 6:53 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>I see. In general, all these methods need experiments to verify their performance. Cheers!</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1vo44wi" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4091737554"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4091737554-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4091729341-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4091719715-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-4061237400"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4061237400"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_793TmcVrXf/" data-action="profile" data-username="disqus_793TmcVrXf" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="202833309" src="./avatar92(15).jpg" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_793TmcVrXf/" data-action="profile" data-username="disqus_793TmcVrXf" target="_blank" rel="noopener noreferrer">Justas Bieliauskas</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4061237400" data-role="relative-time" class="time-ago" title="Sunday, August 26, 2018 6:08 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>How do we evaluate the model? What methods should we use?<br>It is my understanding that the model is accurate if it is able to produce embeddings such that the distance between two embeddings of the same class less than some threshold. How do we find this threshold?<br>I wrote this question here: <a href="https://disq.us/url?url=https%3A%2F%2Fdatascience.stackexchange.com%2Fquestions%2F37445%2Ftriplet-loss-what-threshold-to-use-to-detect-similarity-between-two-embeddings%3AoJ-eGBf1iB6i8hdUPh7N-d0WX9Q&amp;cuid=5136996" rel="nofollow noopener" title="https://datascience.stackexchange.com/questions/37445/triplet-loss-what-threshold-to-use-to-detect-similarity-between-two-embeddings">https://datascience.stackex...</a></p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1v5yeu0" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4061237400"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-4073712163"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="4073712163"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-4061237400" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Justas Bieliauskas</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-4073712163" data-role="relative-time" class="time-ago" title="Sunday, September 2, 2018 5:02 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Yes the margin parameter can be used as a threshold to classify two images as belonging to the same class or not.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1vddsf7" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:4073712163"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4073712163-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-4061237400-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-3959917394"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3959917394"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/omkargune/" data-action="profile" data-username="omkargune" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="290806695" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/omkargune/" data-action="profile" data-username="omkargune" target="_blank" rel="noopener noreferrer">Omkar Gune</a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3959917394" data-role="relative-time" class="time-ago" title="Monday, June 25, 2018 2:45 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Thanks for the wonderful post. I have one doubt. Would this code work if embeddings are from multiple modalities. Specifically, instead of one embedding matrix there are two matrices containing embeddings from two different domains. (number of embeddings and dimensions match.). In such cases, only change would be in the calculation of pairwise distance matrix which may not have zeros in the diagonal. Am I correct ? Thanks.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1thmrte" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3959917394"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3961486978"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3961486978"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-3959917394" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Omkar Gune</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3961486978" data-role="relative-time" class="time-ago" title="Tuesday, June 26, 2018 2:36 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Let's take the example where you have images and their captions, and you embed each into the same space.</p><p>It depends on the task that you want to accomplish, but if the goal is just to push the embeddings of an image and its caption to the same point you can create triplets with (anchor = image, positive = true caption, negative = another caption).<br>In the current code that would amount to giving a unique label to each couple (image, caption).</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1tikewy" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3961486978"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3961588683"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3961588683"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/omkargune/" data-action="profile" data-username="omkargune" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="290806695" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/omkargune/" data-action="profile" data-username="omkargune" target="_blank" rel="noopener noreferrer">Omkar Gune</a></span> </span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-3961486978" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Olivier Moindrot</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3961588683" data-role="relative-time" class="time-ago" title="Tuesday, June 26, 2018 3:55 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>Yes. So, in order to use above code, only change would be in the calculation of pairwise distance matrix. My doubt is would the rest of the code still applicable, as its dependency is on pairwise distances? Thank you.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1timle3" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3961588683"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"><li class="post" id="post-3961709166"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3961709166"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="232266951" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/oliviermoindrot/" data-action="profile" data-username="oliviermoindrot" target="_blank" rel="noopener noreferrer">Olivier Moindrot</a></span> <span class="badge moderator">Mod</span></span><span> <a href="https://omoindrot.github.io/triplet-loss#comment-3961588683" class="parent-link" data-role="parent-link"><i aria-label="in reply to" class="icon-forward" title="in reply to"></i> Omkar Gune</a></span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3961709166" data-role="relative-time" class="time-ago" title="Tuesday, June 26, 2018 5:13 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>In your case I would create an artificial label with one class for each (image, caption) pair.</p><p>So if you have an input like [image_1, caption_1, image_10, caption_10, image_32, caption_32] you could add labels like [1, 1, 10, 10, 32, 32] and use the code as is.</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1tip6cu" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3961709166"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3961709166-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3961588683-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3961486978-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3959917394-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li><li class="post" id="post-3894430077"><div role="alert"></div><div data-role="post-content" class="post-content" tabindex="0"><div class="indicator"></div><ul class="post-menu dropdown" data-role="menu" data-view-id="post-menu" data-post-id="3894430077"><li class="post-menu-item collapse"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Collapse" name="Collapse"><span></span></a></li><li class="post-menu-item expand"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="collapse" title="Expand" name="Collapse"><span>+</span></a></li><li class=" post-menu-item" role="menuitem"><a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate"><i aria-hidden="true" class="icon icon-flag"></i></a></li></ul><div class="avatar hovercard"><a href="https://disqus.com/by/disqus_ynbojnidhe/" data-action="profile" data-username="disqus_ynbojnidhe" target="_blank" rel="noopener noreferrer" class="user"><img data-role="user-avatar" data-user="283686138" src="./noavatar92.png" alt="Avatar"></a></div><div class="post-body"><header class="comment__header"><span class="post-byline"><span> <span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_ynbojnidhe/" data-action="profile" data-username="disqus_ynbojnidhe" target="_blank" rel="noopener noreferrer"></a></span> </span></span> <span class="post-meta"><span class="bullet time-ago-bullet" aria-hidden="true"></span> <a href="https://omoindrot.github.io/triplet-loss#comment-3894430077" data-role="relative-time" class="time-ago" title="Thursday, May 10, 2018 5:16 PM">2 years ago</a> </span>  </header><div class="post-body-inner"><div class="post-message-container" data-role="message-container"><div class="publisher-anchor-color" data-role="message-content"><div class="post-message " data-role="message" dir="auto"><div><p>We are currently training with 4 images and 20 batchesize each (for face recognition). However, the loss does not decrease further from 0.2 and does not increase accuracy (the learning rate has already been adjusted!). please can you help me ?</p></div></div><span class="post-media"><ul data-role="post-media-list"></ul></span></div></div><a class="see-more hidden" title="see more" data-action="see-more">see more</a></div><footer class="comment__footer"><menu class="comment-footer__menu"><li class="voting" data-role="voting"><div class="post-votes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up" name="Vote up"><span class="updatable count" data-role="likes">0</span> <span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span></a><div class="post-votes__separator"></div><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="vote-down  count-0" data-action="downvote" title="Vote down" name="Vote down"><span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span> <span class="updatable count" data-role="dislikes">0</span></a></div></li><li class="bullet" aria-hidden="true"></li><li class="reply" data-role="reply-link"><a class="comment-footer__action" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="reply"><span class="text">Reply</span></a></li><li class="bullet" aria-hidden="true"></li><li class="comment__share"><a class="toggle" tabindex="0"><span class="text">Share </span></a><ul class="comment-share__buttons"><div class="comment-share__social-share-buttons"><li class="twitter"><button class="share__button icon icon-twitter" data-action="share:twitter"></button></li><li class="facebook"><button class="share__button icon icon-facebook" data-action="share:facebook"></button></li></div><li class="link"><button class="share__button icon icon-link" value="http://disq.us/p/1sen5h9" name="Link" title="Click to copy post link" data-action="copy-link"></button><input class="share__button link_url" name="Link" title="Click to copy post link" data-action="copy-link" readonly=""></li></ul></li><li class="realtime" data-role="realtime-notification:3894430077"><span class="realtime-replies" style="display: none;"></span><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" class="realtime-button" style="display: none;"></a></li></menu></footer></div><div data-role="blacklist-form"></div><div data-role="flagging-form"></div><div class="reply-form-container" data-role="reply-form"></div></div><div class="children"><ul data-role="children"></ul><div class="show-children-wrapper hidden"><a class="show-children" id="post-3894430077-show-children" data-action="show-children" href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#">Show more replies</a></div></div></li></ul><div class="load-more" data-role="more" style=""><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" data-action="more-posts" class="btn load-more__button" data-tid="1351">Load more comments</a></div></div></section><div id="placement-bottom" data-tracking-area="discovery-south"></div><div id="footer" data-tracking-area="footer" class="disqus-footer__wrapper"><ul class="disqus-footer"><li class="disqus-footer__logo"><a href="https://disqus.com/" rel="nofollow" title="Powered by Disqus" class="disqus-footer__link">Powered by Disqus</a></li><li id="thread-subscribe-button" class="email disqus-footer__item"><div class="default"><a href="https://disqus.com/embed/comments/?base=default&amp;f=omoindrot-github-io&amp;t_i=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_u=https%3A%2F%2Fomoindrot.github.io%2Ftriplet-loss&amp;t_d=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;t_t=Triplet%20Loss%20and%20Online%20Triplet%20Mining%20in%20TensorFlow&amp;s_o=default#" rel="nofollow" data-action="subscribe" title="Subscribe and get email updates from this discussion" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-mail"></i><span class="clip">Subscribe</span><i aria-hidden="true" class="icon icon-checkmark"></i></a></div></li><li class="install disqus-footer__item"><a href="https://publishers.disqus.com/engage?utm_source=omoindrot-github-io&amp;utm_medium=Disqus-Footer" rel="nofollow noopener noreferrer" target="_blank" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-disqus"></i><span class="clip hidden-md">Add Disqus to your site</span><span class="clip visible-md hidden-xs">Add Disqus</span><span class="clip visible-xs">Add</span></a></li><li class="do-not-sell disqus-footer__item"><a href="https://disqus.com/data-sharing-settings/" rel="nofollow noopener noreferrer" target="_blank" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-warning"></i><span class="clip">Do Not Sell My Data</span></a></li></ul></div></div></div></div></div><div id="anonupvote4195994592" class="tooltip-outer message-card" style="bottom: 16923px; top: inherit; left: 60px; display: none;"><div class="vote-action tooltip">You must sign in to up-vote this post.</div></div></body></html>